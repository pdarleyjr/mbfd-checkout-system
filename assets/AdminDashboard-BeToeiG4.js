import{r as l,j as e,R as es,u as ss}from"./index-Deu5cCNe.js";import{c as M,B as k,C as j,a as f,A as Oe,f as ts,g as Fe,h as ie,i as as,j as ls,k as rs,l as ns,r as qe,s as is,u as cs,d as Pe}from"./useApparatusStatus-CGQXIk2Y.js";import{T as P,b as D,g as $,X as ze,a as re,C as os,M as ds}from"./github-CTXGrb2I.js";const xs=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ms=M("arrow-left",xs);const hs=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],J=M("brain",hs);const gs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],U=M("circle-alert",gs);const ps=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ne=M("circle-x",ps);const us=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],bs=M("clipboard-list",us);const ys=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ce=M("clock",ys);const js=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fs=M("image",js);const Ns=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ue=M("lightbulb",Ns);const vs=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ws=M("lock",vs);const ks=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],pe=M("mail",ks);const Cs=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Ss=M("menu",Cs);const As=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],V=M("package",As);const Is=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],oe=M("refresh-cw",Is);const Ls=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_s=M("search",Ls);const Ms=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ve=M("sparkles",Ms);const $s=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Be=M("trending-up",$s);const Rs=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],X=M("truck",Rs);const Ts=[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]],Es=M("warehouse",Ts),Ds=({adminPassword:d,onCriticalAlertCount:p})=>{const[o,g]=l.useState(null),[m,w]=l.useState(!1),[i,x]=l.useState(null),[n,c]=l.useState("week"),[N,A]=l.useState("all"),t=async()=>{if(!d){x("Admin authentication required");return}w(!0),x(null);try{const r=N==="all"?void 0:N,u=await $.getAIInsights(d,n,r);g(u);const S=u.insights.filter(b=>b.toLowerCase().includes("critical")||b.toLowerCase().includes("immediate")||b.toLowerCase().includes("urgent")).length;p&&p(S)}catch(r){console.error("Error loading AI insights:",r),x(r.message||"Failed to load AI insights")}finally{w(!1)}},y=(r,u)=>{const S=r.toLowerCase().includes("critical")||r.toLowerCase().includes("urgent"),b=r.toLowerCase().includes("warning")||r.toLowerCase().includes("attention"),v=r.toLowerCase().includes("good")||r.toLowerCase().includes("excellent")||r.toLowerCase().includes("optimal");let L="bg-blue-50",R="border-blue-200",I="text-blue-800",F=e.jsx(D,{className:"w-5 h-5 text-blue-600"});return S?(L="bg-red-50",R="border-red-200",I="text-red-800",F=e.jsx(P,{className:"w-5 h-5 text-red-600"})):b?(L="bg-yellow-50",R="border-yellow-200",I="text-yellow-800",F=e.jsx(P,{className:"w-5 h-5 text-yellow-600"})):v&&(L="bg-green-50",R="border-green-200",I="text-green-800",F=e.jsx(D,{className:"w-5 h-5 text-green-600"})),e.jsxs("div",{className:`flex items-start gap-3 p-4 ${L} rounded-lg border ${R}`,children:[F,e.jsx("p",{className:`text-sm font-medium ${I} flex-1`,children:r})]},u)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(J,{className:"w-7 h-7 text-blue-600"}),"Fleet Insights - AI Analysis"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1 flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-purple-600"}),"Powered by Cloudflare Workers AI (Llama 3 8B)"]})]}),e.jsxs(k,{onClick:t,disabled:m,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(oe,{className:`w-4 h-4 ${m?"animate-spin":""}`}),"Refresh Analysis"]})]}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Analysis Timeframe"}),e.jsx("div",{className:"flex gap-2",children:[{value:"week",label:"Last Week"},{value:"month",label:"Last Month"},{value:"all",label:"All Time"}].map(({value:r,label:u})=>e.jsx("button",{onClick:()=>c(r),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${n===r?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:u},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Filter by Apparatus"}),e.jsxs("select",{value:N,onChange:r=>A(r.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"all",children:"All Apparatus"}),Oe.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs(k,{onClick:t,disabled:m,className:"w-full md:w-auto flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),m?"Analyzing Fleet...":"Analyze Fleet"]})})]})}),m&&e.jsx(j,{children:e.jsx(f,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full mb-4 animate-pulse",children:e.jsx(Ve,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"AI Analysis in Progress"}),e.jsx("p",{className:"text-gray-600",children:"Analyzing inspection data and generating insights..."}),e.jsx("div",{className:"mt-4 w-48 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-600 animate-pulse"})})]})})}),i&&!m&&e.jsx(j,{className:"border-red-300",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-red-900 mb-2",children:"Analysis Unavailable"}),e.jsx("p",{className:"text-red-700 text-sm mb-4",children:i}),i.includes("503")||i.includes("enabled")?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-sm text-red-800",children:[e.jsx("p",{className:"font-semibold mb-2",children:"AI service is temporarily unavailable."}),e.jsx("p",{children:"This could be due to:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Cloudflare Workers AI service maintenance"}),e.jsx("li",{children:"AI features not configured in the worker"}),e.jsx("li",{children:"Network connectivity issues"})]}),e.jsx("p",{className:"mt-3 font-medium",children:"You can still view raw data in other dashboard tabs."})]}):e.jsx(k,{onClick:t,variant:"secondary",children:"Try Again"})]})]})})}),!o&&!m&&!i&&e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(J,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Analysis Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No inspection data available for this timeframe."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Try expanding the timeframe or checking other apparatus."})]})}),o&&!m&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{className:"border-blue-300 bg-gradient-to-br from-blue-50 to-purple-50",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 p-3 rounded-full",children:e.jsx(Be,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Analysis Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Data Points"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.dataPoints})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Timeframe"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 capitalize",children:o.timeframe})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Apparatus"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:o.apparatus||"All"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Insights Found"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:o.insights.length})]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Generated at: ",new Date(o.generatedAt).toLocaleString()]})]})]})})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-orange-600"}),"AI-Generated Insights"]}),o.insights.length>0?e.jsx("div",{className:"space-y-3",children:o.insights.map((r,u)=>y(r,u))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(D,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Fleet Operating Optimally"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"AI analysis found no issues or recommendations at this time."})]})]})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-green-600"}),"Fleet Health Score"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Overall Fleet Health"}),e.jsxs("span",{className:`text-lg font-bold ${o.dataPoints>0?"text-green-600":"text-gray-500"}`,children:[o.dataPoints>0?Math.max(70,100-o.insights.length*5):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"h-3 rounded-full bg-gradient-to-r from-green-500 to-emerald-600 transition-all duration-500",style:{width:`${o.dataPoints>0?Math.max(70,100-o.insights.length*5):0}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Critical"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:o.insights.filter(r=>r.toLowerCase().includes("critical")).length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Warnings"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:o.insights.filter(r=>r.toLowerCase().includes("warning")).length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Recommendations"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.insights.filter(r=>!r.toLowerCase().includes("critical")&&!r.toLowerCase().includes("warning")).length})]})]})]})]})})]})]})},Fs=({items:d,isLoading:p,error:o,onRefresh:g})=>{const[m,w]=l.useState(""),[i,x]=l.useState("name"),[n,c]=l.useState("asc"),N=l.useMemo(()=>{let t=d;if(m){const y=m.toLowerCase();t=t.filter(r=>r.equipmentName.toLowerCase().includes(y)||r.equipmentType.toLowerCase().includes(y)||r.location?.toLowerCase().includes(y)||r.description?.toLowerCase().includes(y))}return t=[...t].sort((y,r)=>{let u=0;switch(i){case"name":u=y.equipmentName.localeCompare(r.equipmentName);break;case"quantity":u=y.quantity-r.quantity;break;case"location":u=(y.location||"").localeCompare(r.location||"");break}return n==="asc"?u:-u}),t},[d,m,i,n]),A=t=>{i===t?c(n==="asc"?"desc":"asc"):(x(t),c("asc"))};return o?e.jsx(j,{className:"border-red-300",children:e.jsxs(f,{className:"py-8 text-center",children:[e.jsx(P,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Error Loading Inventory"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:o}),e.jsx(k,{onClick:g,variant:"secondary",children:"Try Again"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(_s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search inventory...",value:m,onChange:t=>w(t.target.value),className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-base"})]}),e.jsx(k,{onClick:g,variant:"secondary",className:"flex-shrink-0 min-w-[44px] min-h-[44px] flex items-center justify-center",disabled:p,"aria-label":"Refresh inventory",children:e.jsx(oe,{className:`w-5 h-5 ${p?"animate-spin":""}`})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>A("name"),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-colors ${i==="name"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Name ",i==="name"&&(n==="asc"?"â†‘":"â†“")]}),e.jsxs("button",{onClick:()=>A("quantity"),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-colors ${i==="quantity"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Quantity ",i==="quantity"&&(n==="asc"?"â†‘":"â†“")]}),e.jsxs("button",{onClick:()=>A("location"),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-colors ${i==="location"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Location ",i==="location"&&(n==="asc"?"â†‘":"â†“")]})]})]}),p?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading inventory..."})]}):N.length===0?e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:m?"No items found":"No inventory items"}),e.jsx("p",{className:"text-gray-600 mt-1",children:m?"Try adjusting your search terms":"Inventory list is empty"})]})}):e.jsx("div",{className:"space-y-3",children:N.map(t=>{const y=t.minQty&&t.quantity<=t.minQty;return e.jsx(j,{className:`hover:shadow-md transition-shadow ${y?"border-orange-300":""}`,children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(V,{className:`w-5 h-5 flex-shrink-0 ${y?"text-orange-600":"text-blue-600"}`}),e.jsx("h3",{className:"font-bold text-gray-900 truncate",children:t.equipmentName}),y&&e.jsx(P,{className:"w-4 h-4 text-orange-600 flex-shrink-0"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Type:"})," ",t.equipmentType]}),t.location&&e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Location:"})," ",t.location," (Shelf ",t.shelf,", Row ",t.row,")"]}),t.manufacturer&&e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Mfg:"})," ",t.manufacturer]}),t.description&&e.jsx("p",{className:"text-gray-500 text-xs mt-2 line-clamp-2",children:t.description})]})]}),e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsx("div",{className:`text-3xl font-bold ${y?"text-orange-600":"text-blue-600"}`,children:t.quantity}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.minQty?`Min: ${t.minQty}`:"in stock"}),y&&e.jsx("div",{className:"text-xs font-semibold text-orange-600 mt-1",children:"LOW STOCK"})]})]})})},t.id)})}),!p&&N.length>0&&e.jsxs("div",{className:"text-center text-sm text-gray-600 py-2",children:["Showing ",N.length," of ",d.length," items"]})]})};function be(d="pending"){const[p,o]=l.useState([]),[g,m]=l.useState(!1),[w,i]=l.useState(null),[x,n]=l.useState(0),c=l.useCallback(async()=>{m(!0),i(null);try{const t=await ts(d);o(t.tasks),n(t.count)}catch(t){const y=t instanceof Error?t.message:"Failed to load tasks";i(y),console.error("Error loading tasks:",t)}finally{m(!1)}},[d]),N=l.useCallback(async(t,y,r,u)=>{try{await Fe(t,{status:"completed",chosenReplacement:y,completedBy:r,notes:u}),await c()}catch(S){throw S}},[c]),A=l.useCallback(async(t,y)=>{try{await Fe(t,{status:"canceled",notes:y}),await c()}catch(r){throw r}},[c]);return l.useEffect(()=>{c()},[c]),{tasks:p,isLoading:g,error:w,count:x,refresh:c,completeTask:N,cancelTask:A}}const qs=()=>{const[d,p]=l.useState("pending"),{tasks:o,isLoading:g,error:m,completeTask:w,cancelTask:i,refresh:x}=be(d),[n,c]=l.useState(null),N=async(t,y)=>{if(confirm(`Mark "${y}" task as completed?`)){c(t);try{await w(t,void 0,"Admin","Completed from dashboard"),alert("Task marked as completed successfully")}catch(r){alert(`Error: ${r instanceof Error?r.message:"Failed to complete task"}`)}finally{c(null)}}},A=async(t,y)=>{const r=prompt(`Cancel "${y}" task? Enter reason (optional):`);if(r!==null){c(t);try{await i(t,r||"Canceled from dashboard"),alert("Task canceled successfully")}catch(u){alert(`Error: ${u instanceof Error?u.message:"Failed to cancel task"}`)}finally{c(null)}}};return m?e.jsx(j,{className:"border-red-300",children:e.jsxs(f,{className:"py-8 text-center",children:[e.jsx(U,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Error Loading Tasks"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:m}),e.jsx(k,{onClick:x,variant:"secondary",children:"Try Again"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>p("pending"),className:`px-4 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap min-w-[120px] ${d==="pending"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ce,{className:"w-5 h-5"}),"Pending"]}),e.jsxs("button",{onClick:()=>p("completed"),className:`px-4 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap min-w-[120px] ${d==="completed"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(D,{className:"w-5 h-5"}),"Completed"]}),e.jsxs("button",{onClick:()=>p("canceled"),className:`px-4 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap min-w-[120px] ${d==="canceled"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ne,{className:"w-5 h-5"}),"Canceled"]})]}),g?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading tasks..."})]}):o.length===0?e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["No ",d," tasks"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:d==="pending"?"All supply tasks are up to date":`No tasks have been ${d}`})]})}):e.jsx("div",{className:"space-y-3",children:o.map(t=>e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold",children:t.apparatus}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${t.deficiencyType==="missing"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.deficiencyType==="missing"?"âŒ Missing":"âš ï¸ Damaged"})]}),e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:t.itemName}),t.compartment&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Compartment: ",t.compartment]})]}),d==="pending"&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ce,{className:"w-6 h-6 text-orange-600"})}),d==="completed"&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(D,{className:"w-6 h-6 text-green-600"})}),d==="canceled"&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ne,{className:"w-6 h-6 text-gray-600"})})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Created by:"})," ",t.createdBy]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Created:"})," ",ie(t.createdAt)]}),t.completedBy&&t.completedAt&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Completed by:"})," ",t.completedBy]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Completed:"})," ",ie(t.completedAt)]})]}),t.notes&&e.jsxs("p",{className:"text-gray-700 bg-gray-50 p-2 rounded mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Notes:"})," ",t.notes]})]}),d==="pending"&&e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(k,{onClick:()=>N(t.id,t.itemName),variant:"primary",size:"sm",className:"flex-1 min-h-[44px]",disabled:n===t.id,children:n===t.id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Mark Complete"]})}),e.jsxs(k,{onClick:()=>A(t.id,t.itemName),variant:"secondary",size:"sm",className:"flex-1 min-h-[44px] bg-red-50 hover:bg-red-100 text-red-700",disabled:n===t.id,children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]})})},t.id))}),!g&&o.length>0&&e.jsxs("div",{className:"text-center text-sm text-gray-600 py-2",children:[o.length," ",d," task",o.length!==1?"s":""]})]})};function Ue(){const[d,p]=l.useState([]),[o,g]=l.useState(!1),[m,w]=l.useState(null),[i,x]=l.useState(null),n=l.useCallback(async()=>{g(!0),w(null);try{const c=await as();p(c.items),x(c.fetchedAt)}catch(c){const N=c instanceof Error?c.message:"Failed to load inventory";w(N),console.error("Error loading inventory:",c)}finally{g(!1)}},[]);return l.useEffect(()=>{n()},[n]),{items:d,isLoading:o,error:m,lastFetchedAt:i,refresh:n}}const Ps=()=>{const{tasks:d,isLoading:p}=be("pending"),{items:o,isLoading:g}=Ue(),m=p||g,w=es.useMemo(()=>d.map(i=>{const x=[];if(i.suggestedReplacements&&i.suggestedReplacements.length>0)return{task:i,suggestions:i.suggestedReplacements.map(c=>({...c,inStock:c.qtyOnHand>0}))};const n=i.itemName.toLowerCase();return o.forEach(c=>{const N=c.equipmentName.toLowerCase(),A=c.equipmentType.toLowerCase();let t=0;N.includes(n)||n.includes(N)?t=.8:(A.includes(n)||n.includes(A))&&(t=.6),t>0&&x.push({itemId:c.id,itemName:c.equipmentName,qtyOnHand:c.quantity,location:c.location,confidence:t,inStock:c.quantity>0})}),x.sort((c,N)=>c.inStock&&!N.inStock?-1:!c.inStock&&N.inStock?1:(N.confidence||0)-(c.confidence||0)),{task:i,suggestions:x.slice(0,3)}}),[d,o]);return m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading suggestions..."})]}):d.length===0?e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"No Pending Tasks"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Suggestions will appear when there are pending supply tasks"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ue,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-900 font-semibold",children:"Inventory Suggestions"}),e.jsx("p",{className:"text-sm text-blue-800 mt-1",children:"Suggested replacements from inventory for pending tasks. Match confidence and stock availability shown."})]})]})}),w.map(({task:i,suggestions:x})=>e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold",children:i.apparatus}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${i.deficiencyType==="missing"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:i.deficiencyType==="missing"?"Missing":"Damaged"})]}),e.jsx("h3",{className:"font-bold text-gray-900",children:i.itemName}),i.compartment&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Compartment: ",i.compartment]})]}),x.length===0?e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx(U,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No matching items found in inventory"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Suggested Replacements:"}),x.map((n,c)=>e.jsx("div",{className:`p-3 rounded-lg border-2 ${n.inStock?"bg-green-50 border-green-300":"bg-gray-50 border-gray-300"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(V,{className:`w-4 h-4 ${n.inStock?"text-green-600":"text-gray-400"}`}),e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:n.itemName})]}),n.location&&e.jsxs("p",{className:"text-xs text-gray-600",children:["Location: ",n.location]}),n.confidence&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Match: ",Math.round(n.confidence*100),"%"]})]}),e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsx("div",{className:`text-2xl font-bold ${n.inStock?"text-green-600":"text-gray-400"}`,children:n.qtyOnHand}),e.jsx("div",{className:`text-xs font-semibold ${n.inStock?"text-green-600":"text-gray-500"}`,children:n.inStock?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-3 h-3"}),"IN STOCK"]}):"OUT OF STOCK"})]})]})},`${n.itemId}-${c}`))]}),x.some(n=>n.inStock)&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-900",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," When marking this task as complete in the Tasks tab, you can select one of these items as the replacement to automatically update inventory."]})})]})})},i.id)),e.jsxs("div",{className:"text-center text-sm text-gray-600 py-2",children:[w.length," task",w.length!==1?"s":""," with suggestions"]})]})};function zs({inventory:d,tasks:p}){const[o,g]=l.useState(!1),[m,w]=l.useState([]),[i,x]=l.useState(!1),[n,c]=l.useState(null),[N,A]=l.useState(!1);l.useEffect(()=>{t()},[]);async function t(){x(!0),c(null);try{const b=await ls();w(b.insights)}catch(b){console.error("Failed to load insights:",b),c(b instanceof Error?b.message:"Failed to load insights")}finally{x(!1)}}async function y(){g(!0),c(null),A(!1);try{const b=await rs({tasks:p.filter(v=>v.status==="pending"),inventory:d});b.ok?setTimeout(()=>{t()},2e3):(A(!0),c(b.message))}catch(b){console.error("Failed to generate insights:",b),c(b instanceof Error?b.message:"Failed to generate insights")}finally{g(!1)}}function r(b){try{return JSON.parse(b)}catch{return null}}const u=m.length>0?m[0]:null,S=u?r(u.insight_json):null;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"AI Insights"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Automated inventory analysis and recommendations"})]}),e.jsx(k,{onClick:y,disabled:o||d.length===0,className:"min-h-[44px] whitespace-nowrap",children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"âš™ï¸"}),"Generating..."]}):"ðŸ¤– Generate Insights"})]}),n&&e.jsx("div",{className:`p-4 rounded-lg ${N?"bg-yellow-50 border border-yellow-200":"bg-red-50 border border-red-200"}`,children:e.jsx("p",{className:`text-sm ${N?"text-yellow-800":"text-red-800"}`,children:N?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"âš ï¸ AI Not Configured:"})," ",n,e.jsx("br",{}),e.jsx("span",{className:"text-xs mt-1 block",children:"This is an optional feature. The system works fully without it."})]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Error:"})," ",n]})})}),i&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin text-4xl",children:"âš™ï¸"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading insights..."})]}),!i&&u&&S&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Generated: ",new Date(u.created_at).toLocaleString(),u.model&&e.jsxs("span",{className:"ml-2",children:["â€¢ Model: ",u.model.split("/").pop()]})]}),S.summary&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ðŸ“Š Summary"}),e.jsx("p",{className:"text-blue-800 text-sm",children:S.summary})]}),S.recurringIssues&&S.recurringIssues.length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-orange-900 mb-2",children:"ðŸ”„ Recurring Issues"}),e.jsx("ul",{className:"space-y-1",children:S.recurringIssues.map((b,v)=>e.jsxs("li",{className:"text-orange-800 text-sm",children:["â€¢ ",b]},v))})]}),S.reorderSuggestions&&S.reorderSuggestions.length>0&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"ðŸ“¦ Reorder Suggestions"}),e.jsx("div",{className:"space-y-3",children:S.reorderSuggestions.map((b,v)=>e.jsx("div",{className:"bg-white rounded p-3 border border-green-100",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-green-900 text-sm",children:b.item}),e.jsx("p",{className:"text-green-700 text-xs mt-1",children:b.reason})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium whitespace-nowrap ${b.urgency?.toLowerCase()==="high"?"bg-red-100 text-red-800":b.urgency?.toLowerCase()==="medium"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:b.urgency||"Normal"})]})},v))})]}),S.anomalies&&S.anomalies.length>0&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"ðŸ” Anomalies Detected"}),e.jsx("ul",{className:"space-y-1",children:S.anomalies.map((b,v)=>e.jsxs("li",{className:"text-purple-800 text-sm",children:["â€¢ ",b]},v))})]})]}),!i&&m.length===0&&!n&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ¤–"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"No insights generated yet"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:'Click "Generate Insights" to analyze your inventory'})]}),m.length>1&&e.jsxs("div",{className:"text-xs text-gray-500 text-center pt-2 border-t border-gray-200",children:[m.length," insights stored â€¢ Showing most recent"]})]})}const Vs=()=>{const[d,p]=l.useState("list"),{items:o,isLoading:g,error:m,refresh:w,lastFetchedAt:i}=Ue(),{tasks:x}=be();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Inventory Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage supply inventory, tasks, and suggested replacements"})]}),i&&!g&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date(i).toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>p("list"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap ${d==="list"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(V,{className:"w-5 h-5"}),"Inventory List"]}),e.jsxs("button",{onClick:()=>p("tasks"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap ${d==="tasks"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(bs,{className:"w-5 h-5"}),"Supply Tasks"]}),e.jsxs("button",{onClick:()=>p("suggestions"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap ${d==="suggestions"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ue,{className:"w-5 h-5"}),"Suggestions"]}),e.jsxs("button",{onClick:()=>p("ai-insights"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 whitespace-nowrap ${d==="ai-insights"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(J,{className:"w-5 h-5"}),"AI Insights"]})]}),e.jsxs("div",{className:"mt-6",children:[d==="list"&&e.jsx(Fs,{items:o,isLoading:g,error:m,onRefresh:w}),d==="tasks"&&e.jsx(qs,{}),d==="suggestions"&&e.jsx(Ps,{}),d==="ai-insights"&&e.jsx(zs,{inventory:o,tasks:x})]})]})};function Os(d={}){const{status:p,pollInterval:o=3e4,autoFetch:g=!0}=d,[m,w]=l.useState([]),[i,x]=l.useState(g),[n,c]=l.useState(null),[N,A]=l.useState(0),[t,y]=l.useState(0),r=l.useCallback(async()=>{x(!0),c(null);try{const v=await ns(p);w(v.requests),A(v.pending),y(v.total)}catch(v){console.error("Error fetching vehicle change requests:",v),c(v instanceof Error?v.message:"Failed to fetch vehicle change requests")}finally{x(!1)}},[p]),u=async v=>{try{await is(v),await r()}catch(L){throw console.error("Error submitting vehicle change request:",L),L}},S=async(v,L,R)=>{try{await qe(v,"approve",L,R),await r()}catch(I){throw console.error("Error approving vehicle change request:",I),I}},b=async(v,L,R)=>{try{await qe(v,"reject",L,R),await r()}catch(I){throw console.error("Error rejecting vehicle change request:",I),I}};return l.useEffect(()=>{g&&r()},[r,g]),l.useEffect(()=>{if(o>0){const v=setInterval(r,o);return()=>clearInterval(v)}},[o,r]),{requests:m,loading:i,error:n,pendingCount:N,totalCount:t,refetch:r,submitRequest:u,approveRequest:S,rejectRequest:b}}const Bs=()=>{const{statuses:d,allVehicles:p,loading:o,error:g,refetch:m}=cs(),{requests:w,loading:i,pendingCount:x,approveRequest:n,rejectRequest:c,refetch:N}=Os({pollInterval:3e4}),[A,t]=l.useState(null),[y,r]=l.useState(!1),[u,S]=l.useState(null),[b,v]=l.useState(""),L=async a=>{if(confirm("Approve this vehicle change? This will update the Google Sheet.")){t(a);try{await n(a,"Admin","Approved by admin dashboard"),alert("Vehicle change approved and sheet updated!"),await m()}catch(_){console.error("Error approving request:",_),alert("Failed to approve request. Please try again.")}finally{t(null)}}},R=async()=>{if(u){t(u);try{await c(u,"Admin",b||"Rejected by admin"),alert("Vehicle change request rejected."),r(!1),S(null),v("")}catch(a){console.error("Error rejecting request:",a),alert("Failed to reject request. Please try again.")}finally{t(null)}}},I=a=>{S(a),r(!0)};if(o||i)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-semibold",children:"Loading apparatus status..."})]})});if(g)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border-2 border-red-300 rounded-xl p-6 text-center",children:[e.jsx(P,{className:"w-12 h-12 text-red-600 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-bold text-red-900 mb-2",children:"Error Loading Apparatus Status"}),e.jsx("p",{className:"text-red-700 mb-4",children:g}),e.jsxs(k,{onClick:m,variant:"secondary",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Retry"]})]})});const F=a=>d.find(W=>W.vehicleNo===a)?.unit||null,O=a=>a.toLowerCase().includes("out of service")?"border-2 border-red-500 bg-red-50 hover:border-red-600":"border-2 border-gray-300 bg-white hover:border-blue-400",H=a=>{const _=a.toLowerCase();return _.includes("out of service")?"bg-red-600 text-white":_.includes("in service")?"bg-green-600 text-white":"bg-gray-600 text-white"};return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Fleet Status"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"All vehicles and current assignments"})]}),e.jsxs(k,{onClick:()=>{m(),N()},variant:"secondary",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),x>0&&e.jsx("div",{className:"bg-amber-50 border-2 border-amber-400 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ce,{className:"w-6 h-6 text-amber-700 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-amber-900 mb-1",children:[x," Pending Vehicle Change Request",x!==1?"s":""]}),e.jsx("p",{className:"text-sm text-amber-800",children:"Review and approve/reject vehicle changes reported by field personnel below."})]})]})}),e.jsxs(j,{children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-6 h-6 text-blue-700"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"All Vehicles"})]})}),e.jsxs(f,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(a=>{const _=F(a.vehicleNo),W=a.status.toLowerCase().includes("out of service");return e.jsxs("div",{className:`${O(a.status)} rounded-lg p-4 transition-colors`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-3xl font-bold text-blue-700",children:["#",a.vehicleNo]}),_&&e.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:_}),!_&&a.designation&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.designation})]}),e.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded ${H(a.status)}`,children:a.status})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[a.assignment&&e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Assignment:"})," ",a.assignment]}),a.currentLocation&&e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Location:"})," ",a.currentLocation]}),a.notes&&e.jsx("p",{className:`text-xs italic mt-2 ${W?"text-red-700 font-semibold":"text-gray-500"}`,children:a.notes})]}),!_&&!a.designation&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-300",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Reserve"})})]},a.vehicleNo)})}),p.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No vehicle data available"})]})]}),e.jsxs(j,{children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-6 h-6 text-orange-700"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Vehicle Change Requests"})]})}),e.jsxs(f,{children:[e.jsxs("div",{className:"space-y-4",children:[w.filter(a=>a.status==="pending").map(a=>e.jsx("div",{className:"border-2 border-orange-300 rounded-lg p-4 bg-orange-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-bold text-gray-900 text-lg",children:a.apparatus}),e.jsx("span",{className:"px-2 py-1 text-xs font-bold bg-orange-200 text-orange-900 rounded",children:"PENDING"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Old Vehicle:"})," #",a.oldVehicleNo||"None"," â†’ ",e.jsx("span",{className:"font-semibold",children:"New Vehicle:"})," #",a.newVehicleNo]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Reported by:"})," ",a.reportedBy]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",new Date(a.reportedAt).toLocaleString()]}),a.notes&&e.jsx("p",{className:"text-gray-500 italic mt-2",children:a.notes})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(k,{onClick:()=>L(a.id),disabled:A===a.id,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(D,{className:"w-4 h-4"}),"Approve"]}),e.jsxs(k,{onClick:()=>I(a.id),disabled:A===a.id,variant:"secondary",className:"flex items-center gap-2 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-900",children:[e.jsx(ne,{className:"w-4 h-4"}),"Reject"]})]})]})},a.id)),w.filter(a=>a.status==="pending").length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No pending vehicle change requests"})]}),w.filter(a=>a.status!=="pending").length>0&&e.jsxs("div",{className:"mt-8 pt-6 border-t-2 border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-4",children:"Recently Processed"}),e.jsx("div",{className:"space-y-3",children:w.filter(a=>a.status!=="pending").slice(0,5).map(a=>e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 bg-gray-50 text-sm",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-gray-900",children:a.apparatus}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded ${a.status==="approved"?"bg-green-200 text-green-900":"bg-red-200 text-red-900"}`,children:a.status.toUpperCase()})]}),e.jsxs("p",{className:"text-gray-600 text-xs",children:["#",a.oldVehicleNo||"None"," â†’ #",a.newVehicleNo," â€¢ Reported by ",a.reportedBy]}),a.reviewedBy&&e.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Reviewed by ",a.reviewedBy," on"," ",new Date(a.reviewedAt).toLocaleString()]})]})})},a.id))})]})]})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Reject Vehicle Change Request"}),e.jsx("p",{className:"text-gray-700 mb-4",children:"Provide a reason for rejecting this vehicle change request:"}),e.jsx("textarea",{value:b,onChange:a=>v(a.target.value),placeholder:"Enter reason for rejection...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none mb-4",rows:4}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(k,{onClick:()=>{r(!1),S(null),v("")},variant:"secondary",className:"flex-1",children:"Cancel"}),e.jsx(k,{onClick:R,disabled:A===u,className:"flex-1 bg-red-600 hover:bg-red-700 text-white",children:"Confirm Reject"})]})]})})]})},Ws=()=>{const d=ss(),[p,o]=l.useState(!1),[g,m]=l.useState(""),[w,i]=l.useState(""),[x,n]=l.useState("fleet"),[c,N]=l.useState(new Map),[A,t]=l.useState([]),[y,r]=l.useState(null),[u,S]=l.useState([]),[b,v]=l.useState(!1),[L,R]=l.useState([]),[I,F]=l.useState(null),[O,H]=l.useState(!1),[a,_]=l.useState(null),[W,ye]=l.useState(!1),[Y,je]=l.useState(!1),[fe,Z]=l.useState(null),[He,Ne]=l.useState(0),[ve,de]=l.useState(null),[T,ee]=l.useState(null),[we,Q]=l.useState(""),[K,ke]=l.useState(!1),[se,Ge]=l.useState(""),[xe,We]=l.useState(null),[te,Ce]=l.useState("defects"),[me,z]=l.useState(!1),Se=async s=>{try{H(!0),F(s),n("activity");const C=(await $.getInspectionLogs(30)).filter(E=>E.title.includes(`[${s}]`));R(C)}catch(h){console.error("Error loading apparatus logs:",h),alert("Failed to load inspection history")}finally{H(!1)}},ae=async()=>{try{H(!0),F(null);const s=await $.getInspectionLogs(30);R(s)}catch(s){console.error("Error loading all inspection logs:",s)}finally{H(!1)}},Ae=async()=>{try{v(!0);const s=await $.getAllDefects(),h=$.computeFleetStatus(s);N(h),t(s);try{const C=await $.getDailySubmissions();r(C)}catch(C){console.error("Error fetching daily submissions:",C)}try{const C=await $.analyzeLowStockItems();S(C)}catch(C){console.error("Error analyzing low stock:",C)}}catch(s){throw console.error("Error loading dashboard data:",s),s instanceof Error&&s.message.includes("Unauthorized")&&(o(!1),$.clearAdminPassword(),localStorage.removeItem("adminPassword")),s}finally{v(!1)}},Ie=async()=>{if(!g.trim()){i("Please enter a password");return}$.setAdminPassword(g),localStorage.setItem("adminPassword",g);try{await Ae(),o(!0),i("")}catch(s){console.error("Authentication failed:",s),s instanceof Error&&s.message.includes("Unauthorized")?i("Incorrect password. Please try again."):s instanceof Error&&s.message.includes("Failed to fetch")?i("Network error. Please check your connection and try again."):i("Authentication failed. Please try again."),$.clearAdminPassword(),localStorage.removeItem("adminPassword")}},Le=async()=>{if(g){ye(!0),Z(null);try{const s=await $.getEmailConfig(g);_(s)}catch(s){Z(s.message||"Failed to load email configuration")}finally{ye(!1)}}},q=async s=>{if(!(!g||!a)){je(!0),Z(null);try{const h=await $.updateEmailConfig(g,s);_(h.config),alert("Email configuration updated successfully")}catch(h){Z(h.message||"Failed to update email configuration")}finally{je(!1)}}},Qe=async()=>{if(g&&confirm("Send a test daily digest email now?"))try{await $.sendManualDigest(g),alert("Test digest sent successfully! Check your email.")}catch(s){alert("Failed to send test digest: "+(s.message||"Unknown error"))}},Ke=async()=>{if(!(!T||!T.issueNumber)){ke(!0);try{await $.resolveDefect(T.issueNumber,we||"Defect resolved via Admin Dashboard","Admin"),t(s=>s.filter(h=>h.issueNumber!==T.issueNumber)),N(s=>{const h=new Map(s),C=h.get(T.apparatus)||0;return h.set(T.apparatus,Math.max(0,C-1)),h}),ee(null),Q(""),alert("Defect successfully resolved!")}catch(s){console.error("Error resolving defect:",s),alert(`Failed to resolve defect: ${s instanceof Error?s.message:"Unknown error"}`)}finally{ke(!1)}}};if(l.useEffect(()=>{if(!p)return;const s=setInterval(()=>{Ae().catch(console.error)},12e4);return()=>clearInterval(s)},[p]),l.useEffect(()=>{p&&x==="activity"&&L.length===0&&!O&&ae()},[p,x]),!p)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-gray-100 flex items-center justify-center p-4",children:e.jsx(j,{className:"max-w-md w-full",children:e.jsxs(f,{className:"py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4",children:e.jsx(ws,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Access Required"}),e.jsx("p",{className:"text-gray-600",children:"Enter the admin password to continue"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:g,onChange:s=>{m(s.target.value),i("")},onKeyDown:s=>{s.key==="Enter"&&Ie()},placeholder:"Enter admin password",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",autoFocus:!0}),w&&e.jsx("p",{className:"text-red-600 text-sm mt-2",children:w})]}),e.jsx(k,{onClick:Ie,className:"w-full",size:"lg",children:"Access Admin Dashboard"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:()=>d("/"),className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"â† Back to Login"})})]})]})})});if(b)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});const le=Oe,Xe=new Date().toLocaleDateString("en-US");return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-900 border-b border-blue-700 shadow-xl sticky top-0 z-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-white rounded-xl flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("img",{src:"/mbfd-checkout-system/mbfd_logo.jpg",alt:"MBFD",className:"w-full h-full object-contain rounded-lg"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white truncate",children:"Admin Dashboard"}),e.jsx("p",{className:"text-xs sm:text-sm text-blue-200 mt-0.5 hidden sm:block",children:"MBFD Fleet Management System"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs(k,{onClick:()=>d("/"),variant:"secondary",className:"hidden sm:flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white border-white/20",size:"sm",children:[e.jsx(ms,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden lg:inline",children:"Back to Login"})]}),e.jsx("button",{onClick:()=>z(!me),className:"sm:hidden p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Toggle menu",children:me?e.jsx(ze,{className:"w-6 h-6 text-white"}):e.jsx(Ss,{className:"w-6 h-6 text-white"})})]})]}),e.jsx("div",{className:`${me?"block":"hidden sm:block"}`,children:e.jsxs("div",{className:"flex gap-1 border-b border-blue-700 overflow-x-auto pb-px scrollbar-hide",children:[e.jsx(B,{icon:U,label:"Inspection Issues",isActive:x==="fleet",onClick:()=>{n("fleet"),z(!1)}}),e.jsx(B,{icon:re,label:"Daily Activity",isActive:x==="activity",onClick:()=>{n("activity"),z(!1)}}),e.jsx(B,{icon:V,label:"Supply Alerts",badge:u.length,isActive:x==="supplies",onClick:()=>{n("supplies"),z(!1)}}),e.jsx(B,{icon:Es,label:"Inventory",isActive:x==="inventory",onClick:()=>{n("inventory"),z(!1)}}),e.jsx(B,{icon:X,label:"Apparatus Status",isActive:x==="apparatus-status",onClick:()=>{n("apparatus-status"),z(!1)}}),e.jsx(B,{icon:pe,label:"Notifications",isActive:x==="notifications",onClick:()=>{n("notifications"),a||Le(),z(!1)}}),e.jsx(B,{icon:J,label:"Fleet Insights",badge:He,badgeColor:"red",isActive:x==="insights",onClick:()=>{n("insights"),Ne(0),z(!1)}})]})})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[x==="fleet"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Equipment & Inventory Issues by Apparatus"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:le.map(s=>{const h=c.get(s)||0,C=h===0;return e.jsx("div",{className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>Se(s),children:e.jsx(j,{className:C?"border-green-500":"border-red-500",children:e.jsxs(f,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(X,{className:`w-8 h-8 ${C?"text-green-500":"text-red-500"}`}),C?e.jsx(D,{className:"w-6 h-6 text-green-500"}):e.jsx(U,{className:"w-6 h-6 text-red-500"})]}),e.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:s}),e.jsx("p",{className:`text-sm font-semibold ${C?"text-green-600":"text-red-600"}`,children:C?"âœ“ No Issues":`${h} Issue${h!==1?"s":""}`}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Click to view history"})]})})},s)})})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Ce("defects"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${te==="defects"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(U,{className:"w-5 h-5"}),"Open Issues (",A.length,")"]}),e.jsxs("button",{onClick:()=>{Ce("history"),L.length===0&&!O&&ae()},className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${te==="history"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(re,{className:"w-5 h-5"}),"Inspection History (Last 30 Days)",I&&e.jsxs("span",{className:"text-sm text-blue-600",children:["- ",I]})]})]})}),te==="defects"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search defects...",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",value:se,onChange:s=>Ge(s.target.value)}),e.jsxs("select",{value:xe||"",onChange:s=>We(s.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"All Apparatus"}),le.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),A.length===0?e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(D,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"No Open Issues"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"All apparatus equipment and inventory are fully operational"})]})}):e.jsx("div",{className:"space-y-3",children:A.filter(s=>(!xe||s.apparatus===xe)&&(s.item.toLowerCase().includes(se.toLowerCase())||s.compartment.toLowerCase().includes(se.toLowerCase())||s.apparatus.toLowerCase().includes(se.toLowerCase()))).sort((s,h)=>s.apparatus.localeCompare(h.apparatus)||s.compartment.localeCompare(h.compartment)||s.item.localeCompare(h.item)).map(s=>e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold",children:s.apparatus}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${s.status==="missing"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status==="missing"?"âŒ Missing":"âš ï¸ Damaged"})]}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:[s.compartment,": ",s.item]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-2",children:["Reported by ",s.reportedBy," on ",ie(s.reportedAt)]}),s.notes&&e.jsx("p",{className:"text-gray-700 text-sm bg-gray-50 p-3 rounded-lg mb-2 break-words",children:s.notes.split(`
`).slice(0,3).join(`
`)}),s.photoUrl&&e.jsx("div",{className:"mt-3",children:e.jsxs("button",{onClick:()=>de(s.photoUrl||null),className:"inline-flex items-center gap-2 px-3 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors border border-blue-200",children:[e.jsx(fs,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-semibold",children:"View Photo"})]})})]}),e.jsx("div",{className:"md:text-right flex-shrink-0",children:e.jsxs(k,{onClick:()=>{ee(s),Q("")},className:"bg-green-600 hover:bg-green-700",size:"sm",children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),"Resolve"]})})]})})},`${s.apparatus}-${s.item}-${s.issueNumber}`))})]}),te==="history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:I&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold",children:["Filtered: ",I]})}),e.jsxs("div",{className:"flex gap-2",children:[I&&e.jsx(k,{onClick:ae,variant:"secondary",size:"sm",children:"View All"}),e.jsx(k,{onClick:()=>I?Se(I):ae(),variant:"secondary",size:"sm",disabled:O,children:O?"Loading...":"Refresh"})]})]}),O?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading inspection logs..."})]}):L.length===0?e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(re,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:I?`No inspection logs found for ${I} in the last 30 days.`:"No inspection logs found. Click an apparatus card in Fleet Status to view its history."})]})}):e.jsx("div",{className:"space-y-3",children:L.map(s=>{const h=s.title.match(/\[(.+)\]\s+Daily Inspection\s*-\s*(.+)/),C=h?h[1]:"Unknown",E=h?h[2]:ie(s.created_at),G=s.body?.match(/\*\*Conducted By:\*\*\s*(.+?)\s*\((.+?)\)/),Je=G?G[1]:"Unknown",_e=G?G[2]:"",Me=s.body?.match(/\*\*Total Items Checked:\*\*\s*(\d+)/),Ye=Me?parseInt(Me[1]):0,$e=s.body?.match(/\*\*Issues Found:\*\*\s*(\d+)/),he=$e?parseInt($e[1]):0,Re=s.body?.match(/\[View Full Printable Receipt\]\((.+?)\)/),Te=Re?Re[1]:null,Ee=s.body?.match(/### Issues Reported\n([\s\S]+?)(?:\n\n|$)/),De=Ee?Ee[1].split(`
`).filter(ge=>ge.trim().startsWith("-")):[];return e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsxs(f,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold",children:C}),he===0?e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold flex items-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),"All Clear"]}):e.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-semibold flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),he," Issue",he!==1?"s":""]})]}),e.jsxs("p",{className:"text-sm text-gray-700 mb-1",children:[e.jsx("strong",{children:"Inspector:"})," ",Je," ",_e&&`(${_e})`]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Date:"})," ",E," â€¢ ",e.jsx("strong",{children:"Items Checked:"})," ",Ye]})]}),e.jsxs("div",{className:"text-right text-xs text-gray-500 flex-shrink-0",children:["#",s.number]})]}),De.length>0&&e.jsxs("div",{className:"mb-4 bg-red-50 border-l-4 border-red-500 p-3 rounded",children:[e.jsx("p",{className:"text-sm font-semibold text-red-900 mb-2",children:"Reported Issues:"}),e.jsx("ul",{className:"text-sm text-red-800 space-y-1",children:De.map((ge,Ze)=>e.jsx("li",{className:"pl-2 break-words",children:ge.replace(/^-\s*/,"")},Ze))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-gray-200",children:[Te&&e.jsx("a",{href:Te,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded text-sm font-semibold transition-colors",children:"ðŸ“‹ View Receipt"}),e.jsx("a",{href:`https://github.com/pdarleyjr/mbfd-checkout-system/issues/${s.number}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded text-sm font-semibold transition-colors",children:"View on GitHub â†’"})]})]})},s.number)})})]}),e.jsx(ds,{isOpen:T!==null,onClose:()=>{K||(ee(null),Q(""))},title:"Resolve Defect",children:T&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Apparatus"}),e.jsx("p",{className:"font-semibold text-gray-900",children:T.apparatus})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Defect"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[T.compartment,": ",T.item]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Status"}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-semibold ${T.status==="missing"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:T.status==="missing"?"âŒ Missing":"âš ï¸ Damaged"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"resolution-note",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Resolution Notes (Optional)"}),e.jsx("textarea",{id:"resolution-note",value:we,onChange:s=>Q(s.target.value),placeholder:"Describe how this defect was resolved...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none",rows:4,disabled:K})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(k,{onClick:Ke,className:"flex-1 bg-green-600 hover:bg-green-700",disabled:K,children:K?"Resolving...":"Confirm Resolution"}),e.jsx(k,{onClick:()=>{ee(null),Q("")},variant:"secondary",disabled:K,children:"Cancel"})]})]})}),ve&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 p-4",onClick:()=>de(null),children:[e.jsx("button",{onClick:()=>de(null),className:"absolute top-4 right-4 p-2 bg-white rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:e.jsx(ze,{className:"w-6 h-6 text-gray-900"})}),e.jsx("img",{src:ve,alt:"Defect photo",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:s=>s.stopPropagation()})]})]}),x==="activity"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"w-6 h-6"}),"Daily Activity - ",Xe]}),e.jsx(j,{className:"mb-6",children:e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Today's Submissions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:le.map(s=>{const h=y?.today.includes(s)||!1;return e.jsxs("div",{className:`p-4 rounded-lg border-2 ${h?"bg-green-50 border-green-500":"bg-gray-50 border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(X,{className:`w-6 h-6 ${h?"text-green-600":"text-gray-400"}`}),h?e.jsx(D,{className:"w-5 h-5 text-green-600"}):e.jsx(U,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("p",{className:"font-bold text-gray-900",children:s}),e.jsx("p",{className:`text-sm font-semibold ${h?"text-green-600":"text-gray-500"}`,children:h?"âœ“ Submitted":"Pending"})]},s)})})]})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Be,{className:"w-5 h-5"}),"Submission Statistics (Last 30 Days)"]}),e.jsx("div",{className:"space-y-3",children:le.map(s=>{const h=y?.totals.get(s)||0,C=y?.lastSubmission.get(s),E=Math.round(h/30*100);return e.jsxs("div",{className:"border-b border-gray-200 pb-3 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:h}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:"submissions"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[E,"% compliance rate"]}),C&&e.jsxs("span",{children:["Last: ",C]})]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${E>=80?"bg-green-500":E>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(E,100)}%`}})})]},s)})})]})})]})}),x==="supplies"&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-6 h-6 text-orange-600"}),"Supply Alerts"]}),u.length===0?e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"No Supply Concerns"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"All items are adequately stocked"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-orange-50 border-l-4 border-orange-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-orange-800",children:[e.jsx("strong",{children:"Note:"})," Items listed below have been reported missing multiple times across different apparatus in the last 30 days. This may indicate a supply shortage requiring attention."]})}),u.map((s,h)=>e.jsx(j,{className:"border-orange-300",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(P,{className:"w-6 h-6 text-orange-600"}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[s.compartment,": ",s.item]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsxs("strong",{children:["Reported missing ",s.occurrences," time",s.occurrences!==1?"s":""]})," in the last 30 days"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Affected apparatus:"}),s.apparatus.map(C=>e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs font-semibold",children:C},C))]})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx("span",{className:"inline-flex items-center justify-center w-12 h-12 bg-orange-100 rounded-full",children:e.jsx("span",{className:"text-xl font-bold text-orange-600",children:s.occurrences})})})]})})},h))]})]}),x==="inventory"&&e.jsx(Vs,{}),x==="apparatus-status"&&e.jsx(Bs,{}),x==="insights"&&e.jsx(e.Fragment,{children:e.jsx(Ds,{adminPassword:g,onCriticalAlertCount:Ne})}),x==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Email Notifications"}),e.jsxs(k,{onClick:Qe,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Send Test Digest"]})]}),fe&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:fe}),W?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading configuration..."})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.enabled?"Notifications are currently enabled":"Notifications are currently disabled"})]}),e.jsx(k,{onClick:()=>q({enabled:!a.enabled}),className:a.enabled?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",disabled:Y,children:a.enabled?"Disable":"Enable"})]})})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Mode"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"email_mode",value:"daily_digest",checked:a.email_mode==="daily_digest",onChange:s=>q({email_mode:s.target.value}),className:"mt-1 w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Daily Digest (Recommended)"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Send one summary email per day at ",a.digest_send_time]})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"email_mode",value:"per_submission",checked:a.email_mode==="per_submission",onChange:s=>q({email_mode:s.target.value}),className:"mt-1 w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Per Submission"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send an email immediately after each inspection"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"email_mode",value:"hybrid",checked:a.email_mode==="hybrid",onChange:s=>q({email_mode:s.target.value}),className:"mt-1 w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Hybrid"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Immediate for critical defects, daily digest for routine"})]})]})]})]})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Recipients"}),e.jsxs("div",{className:"space-y-3",children:[a.recipients.map((s,h)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"email",value:s,onChange:C=>{const E=[...a.recipients];E[h]=C.target.value,_({...a,recipients:E})},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"}),e.jsx(k,{onClick:()=>{const C=a.recipients.filter((E,G)=>G!==h);q({recipients:C})},variant:"secondary",className:"bg-red-50 hover:bg-red-100 text-red-700",children:"Remove"})]},h)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{onClick:()=>{const s=[...a.recipients,""];_({...a,recipients:s})},variant:"secondary",children:"+ Add Recipient"}),e.jsx(k,{onClick:()=>q({recipients:a.recipients.filter(s=>s!=="")}),disabled:Y,children:"Save Recipients"})]})]})]})}),e.jsx(j,{children:e.jsx(f,{className:"p-6",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.enable_immediate_for_critical,onChange:s=>q({enable_immediate_for_critical:s.target.checked}),className:"mt-1 w-5 h-5 text-blue-600 rounded"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Immediate Alerts for Critical Defects"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Send immediate email when critical defects are found (only in hybrid mode)"})]})]})})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Daily Email Limit"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"number",value:a.daily_email_hard_cap,onChange:s=>_({...a,daily_email_hard_cap:parseInt(s.target.value)||250}),className:"w-32 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"500"}),e.jsx("span",{className:"text-gray-600",children:"emails per day (max: 500)"}),e.jsx(k,{onClick:()=>q({daily_email_hard_cap:a.daily_email_hard_cap}),disabled:Y,children:"Save"})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Current: ",a.daily_email_hard_cap," / Recommended: 250"]})]})}),e.jsx(j,{children:e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Subject Template"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:a.email_subject_template,onChange:s=>_({...a,email_subject_template:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"MBFD Daily Inspection Summary - {date}"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Use ","{date}"," for the current date"]}),e.jsx(k,{onClick:()=>q({email_subject_template:a.email_subject_template}),disabled:Y,children:"Save Template"})]})]})})]}):e.jsx(j,{children:e.jsxs(f,{className:"py-12 text-center",children:[e.jsx(pe,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Click the button below to load email configuration"}),e.jsx(k,{onClick:Le,children:"Load Configuration"})]})})]})]})]})},B=({icon:d,label:p,badge:o,badgeColor:g="red",isActive:m,onClick:w})=>e.jsxs("button",{onClick:w,className:`
        flex items-center gap-2 px-3 sm:px-4 lg:px-6 py-2 sm:py-3 font-semibold
        transition-all whitespace-nowrap relative flex-shrink-0 text-sm sm:text-base
        ${m?"text-white border-b-2 border-white bg-white/10":"text-blue-200 hover:text-white hover:bg-white/5"}
      `,children:[e.jsx(d,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:p}),o!==void 0&&o>0&&e.jsx("span",{className:`
          ${g==="red"?"bg-red-500":"bg-yellow-500"}
          text-white text-xs px-2 py-0.5 rounded-full font-bold min-w-[20px] text-center
        `,children:o})]});export{Ws as AdminDashboard};
//# sourceMappingURL=AdminDashboard-BeToeiG4.js.map
