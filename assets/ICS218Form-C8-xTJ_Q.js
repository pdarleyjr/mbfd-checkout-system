import{j as e,m as y,A as C}from"./ui-CK6awmVK.js";import{r as h,u as D}from"./vendor-DtipCrYl.js";import{z as k}from"./index-O4SU3St8.js";import{S as F,P as R}from"./SignatureCanvas-DRYd7Mbo.js";import{T as w}from"./TouchFeedback-jmoWXbnW.js";import{a as E,S as q,T as M}from"./SkeletonLoader-DZcLVolP.js";import{H as $}from"./house-CWo5VH-O.js";const z=["Buses","Generators","Dozers","Pickups/Sedans","Rental Cars","Heavy Equipment","Emergency Vehicles","Support Vehicles","Other"],W=({formData:t,onChange:l,onNext:g,errors:r})=>{const c=n=>{n.preventDefault(),g()},u=()=>new Date().toISOString().split("T")[0],m=()=>{const n=new Date,b=String(n.getHours()).padStart(2,"0"),f=String(n.getMinutes()).padStart(2,"0");return`${b}:${f}`};return e.jsxs(y.form,{className:"space-y-6 p-4 md:p-6",onSubmit:c,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Incident Information"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Basic incident details for vehicle inventory"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"incidentName",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Incident Name *"}),e.jsx("input",{type:"text",id:"incidentName",value:t.incidentName||"",onChange:n=>l("incidentName",n.target.value),placeholder:"e.g., Wildfire Response 2024",maxLength:100,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${r.incidentName?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
          `,style:{minHeight:"56px"}}),r.incidentName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.incidentName})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"incidentNumber",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Incident Number *"}),e.jsx("input",{type:"text",id:"incidentNumber",value:t.incidentNumber||"",onChange:n=>l("incidentNumber",n.target.value),placeholder:"e.g., INC-2024-00123",maxLength:50,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${r.incidentNumber?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
          `,style:{minHeight:"56px"}}),r.incidentNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.incidentNumber})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"datePrepared",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Date Prepared *"}),e.jsx("input",{type:"date",id:"datePrepared",value:t.datePrepared||u(),onChange:n=>l("datePrepared",n.target.value),max:u(),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${r.datePrepared?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
            `,style:{minHeight:"56px"}}),r.datePrepared&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.datePrepared})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timePrepared",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Time Prepared *"}),e.jsx("input",{type:"time",id:"timePrepared",value:t.timePrepared||m(),onChange:n=>l("timePrepared",n.target.value),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${r.timePrepared?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
            `,style:{minHeight:"56px"}}),r.timePrepared&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.timePrepared})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vehicleCategory",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Vehicle/Equipment Category *"}),e.jsxs("select",{id:"vehicleCategory",value:t.vehicleCategory||"",onChange:n=>l("vehicleCategory",n.target.value),className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${r.vehicleCategory?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
          `,style:{minHeight:"56px"},children:[e.jsx("option",{value:"",children:"Select a category..."}),z.map(n=>e.jsx("option",{value:n,children:n},n))]}),r.vehicleCategory&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.vehicleCategory})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"operationalPeriod",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Operational Period ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",id:"operationalPeriod",value:t.operationalPeriod||"",onChange:n=>l("operationalPeriod",n.target.value),placeholder:"e.g., 0800-2000 Day 1",maxLength:50,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-orange-500 focus:ring-orange-100
          `,style:{minHeight:"56px"}})]}),e.jsx(w,{onTap:()=>g(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
            w-full bg-orange-600 hover:bg-orange-700 text-white font-bold
            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
            focus:outline-none focus:ring-4 focus:ring-orange-300
          `,style:{minHeight:"56px"},children:"Next: Vehicle Table"})})]})},K=({value:t,onChange:l,onVehicleSelect:g,apiEndpoint:r="/api/vehicles/autocomplete",className:c="",error:u})=>{const[m,n]=h.useState(!1),[b,f]=h.useState([]),[d,N]=h.useState(!1),[i,s]=h.useState(t),a=h.useRef(null),j=h.useRef(null);h.useEffect(()=>{if(a.current&&clearTimeout(a.current),i.trim().length<2){f([]),n(!1);return}return a.current=setTimeout(async()=>{N(!0);try{const o=await fetch(`${r}?q=${encodeURIComponent(i)}`);if(o.ok){const v=await o.json();f(v.vehicles||[]),n(!0)}}catch(o){console.error("Vehicle search error:",o),f([])}finally{N(!1)}},300),()=>{a.current&&clearTimeout(a.current)}},[i,r]),h.useEffect(()=>{const o=v=>{j.current&&!j.current.contains(v.target)&&n(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const T=o=>{const v=o.target.value;s(v),l(v)},P=o=>{s(o.regUnit||""),l(o.regUnit||"",o),g?.(o),n(!1)};return e.jsxs("div",{ref:j,className:`relative ${c}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:i,onChange:T,onFocus:()=>i.length>=2&&n(!0),placeholder:"Search vehicle ID, make, or type...",className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${u?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            ${d?"pr-12":""}
          `,style:{minHeight:"48px"}}),d&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx(y.div,{className:"w-5 h-5 border-3 border-blue-500 border-t-transparent rounded-full",animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"}})})]}),u&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u}),e.jsx(C,{children:m&&b.length>0&&e.jsx(y.div,{className:"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-h-80 overflow-y-auto",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:b.map(o=>e.jsx(y.button,{onClick:()=>P(o),className:"w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border-b border-gray-200 dark:border-gray-700 last:border-b-0",style:{minHeight:"56px"},whileHover:{backgroundColor:"rgba(59, 130, 246, 0.1)"},whileTap:{scale:.98},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:o.regUnit}),(o.vehicleMake||o.vehicleType)&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.vehicleMake,o.vehicleType].filter(Boolean).join(" ")}),o.licenseNumber&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-0.5",children:o.licenseNumber})]}),o.vehicleStatus&&e.jsx("span",{className:`
                        ml-3 px-2 py-1 text-xs font-medium rounded-full
                        ${o.vehicleStatus==="Active"?"bg-green-100 text-green-800":o.vehicleStatus==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}
                      `,children:o.vehicleStatus})]})},o.id))})}),d&&m&&e.jsx("div",{className:"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4",children:e.jsx(E,{type:"text",count:3})})]})},U=({formData:t,onChange:l,onNext:g,onBack:r,errors:c})=>{const[u,m]=h.useState(0),n=i=>{i.preventDefault(),g()},b=()=>{const i={orderRequestNumber:"",incidentIdNo:"",classification:"",make:"",categoryKindType:"",features:"",agencyOwner:"",operatorNameContact:"",vehicleLicenseId:"",incidentAssignment:"",startDateTime:new Date().toISOString().slice(0,16),releaseDateTime:"",airtableId:""},s=[...t.vehicles||[],i];l("vehicles",s),m(s.length-1)},f=i=>{const s=(t.vehicles||[]).filter((a,j)=>j!==i);l("vehicles",s),u===i?m(null):u!==null&&u>i&&m(u-1)},d=(i,s,a)=>{const j=[...t.vehicles||[]];j[i]={...j[i],[s]:a},l("vehicles",j)},N=(i,s)=>{const a=[...t.vehicles||[]];a[i]={...a[i],incidentIdNo:s.vehicleId||"",classification:s.vehicleType||"",make:s.vehicleMake||"",categoryKindType:s.vehicleType||"",features:s.features||"",agencyOwner:s.agency||"",vehicleLicenseId:s.licenseNumber||"",airtableId:s.id||""},l("vehicles",a)};return e.jsxs(y.form,{className:"space-y-6 p-4 md:p-6",onSubmit:n,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle/Equipment Inventory"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add vehicles using Airtable autocomplete. Many fields auto-fill from database."})]}),e.jsx("div",{className:"space-y-4",children:(t.vehicles||[]).map((i,s)=>e.jsxs(y.div,{className:"border-2 border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden bg-white dark:bg-gray-800",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.05},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",onClick:()=>m(u===s?null:s),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-700 dark:text-gray-300",children:["#",s+1]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:i.make||"New Vehicle"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:i.vehicleLicenseId||"No license set"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),f(s)},className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 p-2 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("svg",{className:`w-5 h-5 transition-transform ${u===s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsx(C,{children:u===s&&e.jsxs(y.div,{className:"p-4 space-y-4 border-t border-gray-200 dark:border-gray-700",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"ðŸ” Search Vehicle (Auto-populate from Airtable)"}),e.jsx(K,{value:i.make||"",onChange:a=>d(s,"make",a),onVehicleSelect:a=>N(s,a),className:"w-full"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Search by vehicle ID, make, or type to auto-fill fields"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Order Request # (optional)"}),e.jsx("input",{type:"text",value:i.orderRequestNumber||"",onChange:a=>d(s,"orderRequestNumber",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Incident ID # âœ¨ Auto"}),e.jsx("input",{type:"text",value:i.incidentIdNo||"",onChange:a=>d(s,"incidentIdNo",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Classification âœ¨ Auto *"}),e.jsx("input",{type:"text",value:i.classification||"",onChange:a=>d(s,"classification",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Make âœ¨ Auto *"}),e.jsx("input",{type:"text",value:i.make||"",onChange:a=>d(s,"make",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category/Kind/Type âœ¨ Auto *"}),e.jsx("input",{type:"text",value:i.categoryKindType||"",onChange:a=>d(s,"categoryKindType",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Features âœ¨ Auto"}),e.jsx("input",{type:"text",value:i.features||"",onChange:a=>d(s,"features",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Agency/Owner âœ¨ Auto *"}),e.jsx("input",{type:"text",value:i.agencyOwner||"",onChange:a=>d(s,"agencyOwner",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Operator Name/Contact *"}),e.jsx("input",{type:"text",value:i.operatorNameContact||"",onChange:a=>d(s,"operatorNameContact",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"License/ID # âœ¨ Auto *"}),e.jsx("input",{type:"text",value:i.vehicleLicenseId||"",onChange:a=>d(s,"vehicleLicenseId",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Incident Assignment *"}),e.jsx("input",{type:"text",value:i.incidentAssignment||"",onChange:a=>d(s,"incidentAssignment",a.target.value),placeholder:"e.g., Search & Rescue, Transport",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date/Time *"}),e.jsx("input",{type:"datetime-local",value:i.startDateTime||"",onChange:a=>d(s,"startDateTime",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Release Date/Time (optional)"}),e.jsx("input",{type:"datetime-local",value:i.releaseDateTime||"",onChange:a=>d(s,"releaseDateTime",a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]})]})]})})]},s))}),e.jsx(w,{onTap:b,hapticType:"light",children:e.jsxs("button",{type:"button",onClick:b,className:`
            w-full bg-blue-600 hover:bg-blue-700 text-white font-medium
            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
            focus:outline-none focus:ring-4 focus:ring-blue-300
            flex items-center justify-center gap-2
          `,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Vehicle"]})}),c.vehicles&&e.jsx("p",{className:"text-sm text-red-600 bg-red-50 dark:bg-red-900/20 rounded-lg p-3",children:c.vehicles}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"* Required fields | âœ¨ Auto = Auto-populated from Airtable"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(w,{onTap:r,hapticType:"medium",children:e.jsx("button",{type:"button",onClick:r,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(w,{onTap:()=>g(),hapticType:"medium",children:e.jsxs("button",{type:"submit",className:`
              flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-orange-300
            `,style:{minHeight:"56px"},children:["Next: Prepared By (",(t.vehicles||[]).length," Vehicles)"]})})]})]})},J=({formData:t,onChange:l,onNext:g,onBack:r,errors:c})=>{const[u,m]=h.useState(!1),n=d=>{d.preventDefault(),g()},b=d=>{l("preparedBy",{...t.preparedBy,signature:d,signatureTimestamp:new Date().toISOString()}),m(!1)},f=()=>{l("preparedBy",{...t.preparedBy,signature:"",signatureTimestamp:""})};return e.jsxs(y.form,{className:"space-y-6 p-4 md:p-6",onSubmit:n,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Prepared By Information"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Form preparer details and signature"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"preparedByName",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Name *"}),e.jsx("input",{type:"text",id:"preparedByName",value:t.preparedBy?.name||"",onChange:d=>l("preparedBy",{...t.preparedBy,name:d.target.value}),placeholder:"Enter your full name",maxLength:100,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${c.preparedByName?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
          `,style:{minHeight:"56px"}}),c.preparedByName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.preparedByName})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"preparedByPosition",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Position/Title *"}),e.jsx("input",{type:"text",id:"preparedByPosition",value:t.preparedBy?.positionTitle||"",onChange:d=>l("preparedBy",{...t.preparedBy,positionTitle:d.target.value}),placeholder:"e.g., Equipment Manager, Logistics Chief",maxLength:100,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${c.preparedByPosition?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-orange-500 focus:ring-orange-100"}
          `,style:{minHeight:"56px"}}),c.preparedByPosition&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.preparedByPosition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Signature *"}),t.preparedBy?.signature?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-700 border-2 border-green-500 rounded-xl p-4",children:[e.jsx("img",{src:t.preparedBy.signature,alt:"Signature",className:"max-w-full h-auto",style:{maxHeight:"100px"}}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2",children:["Signed: ",t.preparedBy.signatureTimestamp?new Date(t.preparedBy.signatureTimestamp).toLocaleString():"Unknown"]})]}),e.jsx("button",{type:"button",onClick:f,className:`
                w-full bg-red-100 hover:bg-red-200 text-red-700 font-medium
                py-3 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-red-200
              `,children:"Clear Signature"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:()=>m(!0),className:`
                w-full bg-orange-100 hover:bg-orange-200 text-orange-700 font-medium
                py-4 px-6 rounded-xl transition-all border-2 border-dashed border-orange-300
                focus:outline-none focus:ring-4 focus:ring-orange-200
              `,style:{minHeight:"56px"},children:[e.jsx("span",{className:"text-lg",children:"âœï¸"})," Tap to Sign"]}),c.preparedBySignature&&e.jsx("p",{className:"text-sm text-red-600",children:c.preparedBySignature})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(w,{onTap:r,hapticType:"medium",children:e.jsx("button",{type:"button",onClick:r,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(w,{onTap:()=>g(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
              flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-orange-300
            `,style:{minHeight:"56px"},children:"Next: Review & Submit"})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Sign Here"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(F,{onSave:b})]})})]})},_=({formData:t,onSubmit:l,onBack:g,onGoToStep:r})=>{const[c,u]=h.useState(!1),m=async()=>{u(!0);try{await l()}catch(n){console.error("Submission error:",n)}finally{u(!1)}};return e.jsxs(y.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Review all information before submitting"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Incident Information"}),e.jsx("button",{type:"button",onClick:()=>r(0),className:"text-orange-600 hover:text-orange-700 text-sm font-medium",children:"Edit"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Incident Name:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.incidentName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Incident Number:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.incidentNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Date Prepared:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[t.datePrepared," ",t.timePrepared]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Vehicle Category:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.vehicleCategory})]}),t.operationalPeriod&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Operational Period:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.operationalPeriod})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Vehicle Inventory"}),e.jsx("button",{type:"button",onClick:()=>r(1),className:"text-orange-600 hover:text-orange-700 text-sm font-medium",children:"Edit"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Total vehicles: ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicles?.length||0})]}),t.vehicles&&t.vehicles.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:t.vehicles.map((n,b)=>e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsxs("span",{className:"text-orange-600 font-medium",children:["#",b+1]}),e.jsxs("span",{className:"truncate",children:[n.make," ",n.classification," - ",n.vehicleLicenseId]})]},b))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Prepared By"}),e.jsx("button",{type:"button",onClick:()=>r(2),className:"text-orange-600 hover:text-orange-700 text-sm font-medium",children:"Edit"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Name:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.preparedBy?.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Position/Title:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.preparedBy?.positionTitle})]})]}),t.preparedBy?.signature&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Signature:"}),e.jsx("img",{src:t.preparedBy.signature,alt:"Signature",className:"max-w-full h-auto",style:{maxHeight:"60px"}}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:t.preparedBy.signatureTimestamp&&new Date(t.preparedBy.signatureTimestamp).toLocaleString()})]})]})]}),e.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-200 dark:border-orange-800 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-orange-600 dark:text-orange-400 text-2xl",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-900 dark:text-orange-300 mb-1",children:"Before Submitting"}),e.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-400",children:"Please verify all information is correct. Once submitted, this form will be logged and cannot be edited."})]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(w,{onTap:g,hapticType:"medium",children:e.jsx("button",{type:"button",onClick:g,disabled:c,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-gray-300
              disabled:cursor-not-allowed
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(w,{onTap:m,hapticType:"heavy",children:e.jsx("button",{type:"button",onClick:m,disabled:c,className:`
              flex-1 bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800
              disabled:from-gray-300 disabled:to-gray-400 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-orange-300
              disabled:cursor-not-allowed
            `,style:{minHeight:"56px"},children:c?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"âœ“ Submit Form"})})]})]})},S=[{id:0,title:"Incident Info",component:W},{id:1,title:"Vehicle Table",component:U},{id:2,title:"Prepared By",component:J},{id:3,title:"Review & Submit",component:_}],A={status:"draft",incidentName:"",incidentNumber:"",datePrepared:new Date().toISOString().split("T")[0],timePrepared:new Date().toTimeString().slice(0,5),vehicleCategory:"",operationalPeriod:"",vehicles:[],preparedBy:{name:"",positionTitle:"",signature:"",signatureTimestamp:""}},re=()=>{const t=D(),[l,g]=h.useState(0),[r,c]=h.useState(A),[u,m]=h.useState({}),[n,b]=h.useState(!1),[f,d]=h.useState(!1),[N,i]=h.useState(null);h.useEffect(()=>{const x=setInterval(()=>{if(r&&!n&&l>0){const p={formData:r,currentStep:l,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics218-draft",JSON.stringify(p)),k.success("Draft auto-saved",{duration:1500,icon:"ðŸ’¾"})}},3e4);return()=>clearInterval(x)},[r,l,n]),h.useEffect(()=>{const x=localStorage.getItem("ics218-draft");if(x)try{const p=JSON.parse(x);new Date(p.expiresAt)>new Date?(i(p),d(!0)):localStorage.removeItem("ics218-draft")}catch(p){console.error("Failed to parse draft:",p),localStorage.removeItem("ics218-draft")}},[]);const s=()=>{N&&(c(N.formData),g(N.currentStep),d(!1),k.success("Draft restored!"))},a=()=>{localStorage.removeItem("ics218-draft"),d(!1),i(null),k("Draft discarded",{icon:"ðŸ—‘ï¸"})},j=(x,p)=>{c(I=>({...I,[x]:p})),u[x]&&m(I=>{const B={...I};return delete B[x],B})},T=x=>{const p={};switch(x){case 0:(!r.incidentName||r.incidentName.length<3)&&(p.incidentName="Incident name must be at least 3 characters"),r.incidentNumber||(p.incidentNumber="Incident number is required"),r.datePrepared||(p.datePrepared="Date is required"),r.timePrepared||(p.timePrepared="Time is required"),r.vehicleCategory||(p.vehicleCategory="Vehicle category is required");break;case 1:(!r.vehicles||r.vehicles.length===0)&&(p.vehicles="At least one vehicle must be added");break;case 2:(!r.preparedBy?.name||(r.preparedBy?.name||"").length<2)&&(p.preparedByName="Name must be at least 2 characters"),r.preparedBy?.positionTitle||(p.preparedByPosition="Position/Title is required"),r.preparedBy?.signature||(p.preparedBySignature="Signature is required");break}return m(p),Object.keys(p).length===0},P=()=>{T(l)?l<S.length-1&&g(l+1):k.error("Please complete all required fields")},o=()=>{l>0&&g(l-1)},v=x=>{x>=0&&x<S.length&&g(x)},L=()=>{const x={formData:r,currentStep:l,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics218-draft",JSON.stringify(x)),k.success("Draft saved manually!",{icon:"ðŸ’¾"})},V=()=>{confirm("Are you sure you want to clear all form data? This cannot be undone.")&&(c(A),g(0),m({}),localStorage.removeItem("ics218-draft"),k("Form cleared",{icon:"ðŸ—‘ï¸"}))},H=async()=>{try{const x={...r,id:`ICS218-${Date.now()}`,submittedAt:new Date().toISOString(),status:"submitted"};console.log("ICS 218 Form Data:",x),b(!0),localStorage.removeItem("ics218-draft"),k.success("Form submitted successfully!")}catch(x){throw console.error("Submission error:",x),k.error("Failed to submit form. Please try again."),x}},O=S[l].component;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-40 shadow-sm",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("img",{src:"/taskforce-io-logo.png",alt:"TASKFORCE IO",className:"w-10 h-10 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"ICS-218 Support Vehicle/Equipment Inventory"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Step ",l+1," of ",S.length,": ",S[l].title]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>t("/"),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors",title:"Home",children:e.jsx($,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:L,className:"p-2 rounded-lg bg-orange-100 text-orange-600 hover:bg-orange-200 transition-colors",title:"Save Draft",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:V,className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"Clear Form",children:e.jsx(M,{className:"w-5 h-5"})})]})]}),e.jsx(R,{currentStep:l+1,totalSteps:S.length,labels:S.map(x=>x.title)})]})}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(C,{mode:"wait",children:e.jsx(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(O,{formData:r,onChange:j,onNext:P,onBack:o,onGoToStep:v,onSubmit:H,errors:u})},l)})}),e.jsx(C,{children:f&&e.jsx(y.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(y.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Resume Draft?"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["We found a saved draft from"," ",N&&new Date(N.savedAt).toLocaleString(),". Would you like to resume where you left off?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors",children:"Start Fresh"}),e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-xl transition-colors",children:"Resume Draft"})]})]})})}),e.jsx(C,{children:n&&e.jsx(y.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},children:e.jsxs(y.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-8 text-center",initial:{scale:.9,y:20},animate:{scale:1,y:0},children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Submitted!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your ICS-218 form has been successfully submitted and logged."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>t("/"),className:"flex-1 px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors",children:"Go Home"}),e.jsx("button",{type:"button",onClick:()=>{b(!1),c(A),g(0)},className:"flex-1 px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-xl transition-colors",children:"New Form"})]})]})})})]})};export{re as ICS218Form,re as default};
//# sourceMappingURL=ICS218Form-C8-xTJ_Q.js.map
