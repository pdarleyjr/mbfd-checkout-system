import{j as e,m as f,A}from"./ui-CK6awmVK.js";import{r as h}from"./vendor-DtipCrYl.js";import{c as q,s as R,L as B,z as I}from"./index-O4SU3St8.js";import{S as V,P as z}from"./SignatureCanvas-DRYd7Mbo.js";import{T as k}from"./TouchFeedback-jmoWXbnW.js";import{S as U,a as W,T as J}from"./SkeletonLoader-DZcLVolP.js";import{X,A as $,P as G,T as L}from"./config-BM_7qAFy.js";import{C as E,a as Q,S as D}from"./square-pen-uBbVBcd-.js";import{C as Y}from"./chevron-down-BmT_yDwp.js";const K=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Z=q("loader-circle",K),ee=({formData:t,onChange:i,onNext:d,errors:r})=>{const o=s=>{s.preventDefault(),d()},n=()=>new Date().toISOString().split("T")[0],p=()=>{const s=new Date,m=String(s.getHours()).padStart(2,"0"),x=String(s.getMinutes()).padStart(2,"0");return`${m}:${x}`};return e.jsxs(f.form,{className:"space-y-6 p-4 md:p-6",onSubmit:o,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Incident Information"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Complete prior to vehicle inspection"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"incidentName",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Incident Name *"}),e.jsx("input",{type:"text",id:"incidentName",value:t.incidentName||"",onChange:s=>i("incidentName",s.target.value),placeholder:"e.g., Wildfire Response 2024",maxLength:100,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${r.incidentName?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),r.incidentName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.incidentName})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorDate",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Date *"}),e.jsx("input",{type:"date",id:"inspectorDate",value:t.inspectorDate||n(),onChange:s=>i("inspectorDate",s.target.value),max:n(),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${r.inspectorDate?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            `,style:{minHeight:"56px"}}),r.inspectorDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.inspectorDate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorTime",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Time *"}),e.jsx("input",{type:"time",id:"inspectorTime",value:t.inspectorTime||p(),onChange:s=>i("inspectorTime",s.target.value),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${r.inspectorTime?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            `,style:{minHeight:"56px"}}),r.inspectorTime&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.inspectorTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"orderNo",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Order Number ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",id:"orderNo",value:t.orderNo||"",onChange:s=>i("orderNo",s.target.value),placeholder:"e.g., ORDER-2024-00123",maxLength:50,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-blue-500 focus:ring-blue-100
          `,style:{minHeight:"56px"}})]}),e.jsx(k,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
            w-full bg-blue-600 hover:bg-blue-700 text-white font-bold
            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
            focus:outline-none focus:ring-4 focus:ring-blue-300
          `,style:{minHeight:"56px"},children:"Next: Vehicle Selection"})})]})};function te({isOpen:t,onClose:i,onVehicleAdded:d}){const[r,o]=h.useState({regUnit:"",agency:"",vehicleMake:"",vehicleType:"",incidentId:"",vehicleId:"",features:"",licenseNumber:"",notes:"",vehicleStatus:"Active"}),[n,p]=h.useState({}),[s,m]=h.useState(!1),x=()=>{o({regUnit:"",agency:"",vehicleMake:"",vehicleType:"",incidentId:"",vehicleId:"",features:"",licenseNumber:"",notes:"",vehicleStatus:"Active"}),p({})},y=()=>{s||(x(),i())},N=()=>{const a={};return r.regUnit.trim()?r.regUnit.length>100&&(a.regUnit="Registered Unit must be 100 characters or less"):a.regUnit="Registered Unit is required",r.vehicleMake.trim()||(a.vehicleMake="Vehicle Make is required"),[r.agency,r.vehicleType,r.incidentId,r.vehicleId,r.features,r.licenseNumber,r.notes].some(g=>g.trim())||(a.general="At least one additional field must be filled"),p(a),Object.keys(a).length===0},j=async a=>{if(a.preventDefault(),!N()){R({message:"Please fix the validation errors",type:"error"});return}m(!0);try{const c=await fetch(`${$}/vehicles`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!c.ok){const v=await c.json();throw new Error(v.message||"Failed to create vehicle")}const g=await c.json();R({message:"Vehicle created successfully",type:"success"}),d(g.vehicle),x(),i()}catch(c){console.error("Error creating vehicle:",c),R({message:c instanceof Error?c.message:"Failed to create vehicle",type:"error"})}finally{m(!1)}};return t?e.jsx(A,{children:e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx(f.div,{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:y,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),e.jsxs(f.div,{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Vehicle"}),e.jsx("button",{onClick:y,disabled:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[n.general&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:n.general}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Registered Unit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.regUnit,onChange:a=>o({...r,regUnit:a.target.value}),className:`w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:text-white ${n.regUnit?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"e.g., USAR-01",disabled:s}),n.regUnit&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:n.regUnit})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Agency"}),e.jsx("input",{type:"text",value:r.agency,onChange:a=>o({...r,agency:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., FEMA",disabled:s})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Make ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.vehicleMake,onChange:a=>o({...r,vehicleMake:a.target.value}),className:`w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:text-white ${n.vehicleMake?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"e.g., Ford, Chevrolet, International",disabled:s}),n.vehicleMake&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:n.vehicleMake})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category/Type"}),e.jsx("input",{type:"text",value:r.vehicleType,onChange:a=>o({...r,vehicleType:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., Heavy Rescue Truck, Cargo Trailer",disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"License Number"}),e.jsx("input",{type:"text",value:r.licenseNumber,onChange:a=>o({...r,licenseNumber:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., ABC-1234",disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Incident ID"}),e.jsx("input",{type:"text",value:r.incidentId,onChange:a=>o({...r,incidentId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., INC-2024-001",disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Classification"}),e.jsx("input",{type:"text",value:r.vehicleId,onChange:a=>o({...r,vehicleId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., VEHICLE-001",disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Features"}),e.jsx("textarea",{value:r.features,onChange:a=>o({...r,features:a.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"Describe special features, equipment, or capabilities",disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:r.vehicleStatus,onChange:a=>o({...r,vehicleStatus:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",disabled:s,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Deployed",children:"Deployed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:a=>o({...r,notes:a.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"Additional notes or comments",disabled:s})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-6 sticky bottom-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 -mx-6 px-6 py-4 mt-6",children:[e.jsx("button",{type:"button",onClick:y,disabled:s,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-[#0066FF] text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 h-4"}),"Create Vehicle"]})})]})]})]})]})})}):null}const re=({formData:t,onChange:i,onNext:d,onBack:r,errors:o})=>{const[n,p]=h.useState([]),[s,m]=h.useState(!0),[x,y]=h.useState(null),[N,j]=h.useState(!1);h.useEffect(()=>{a()},[]);const a=async()=>{m(!0);try{const l=await fetch(`${$}/vehicles`);if(!l.ok)throw new Error("Failed to fetch vehicles");const w=await l.json();p(w.vehicles||[])}catch(l){console.error("Error fetching vehicles:",l),R({message:"Failed to load vehicles",type:"error"})}finally{m(!1)}},c=l=>{if(!l){y(null),i("selectedVehicleId",""),i("vehicleIdNo",""),i("vehicleLicenseNo",""),i("vehicleType",""),i("agencyRegUnit","");return}if(l==="__ADD_NEW__"){j(!0);return}const w=n.find(O=>O.id===l);w&&(y(w),i("selectedVehicleId",w.id),i("vehicleIdNo",w.vehicleId||""),i("vehicleLicenseNo",w.licenseNumber||""),i("vehicleType",w.vehicleType||""),i("agencyRegUnit",w.regUnit||""))},g=async l=>{await a(),y(l),i("vehicleIdNo",l.vehicleId||""),i("vehicleLicenseNo",l.licenseNumber||""),i("vehicleType",l.vehicleType||""),i("agencyRegUnit",l.regUnit||"")},v=l=>{l.preventDefault(),d()};return e.jsxs(f.form,{className:"space-y-6 p-4 md:p-6",onSubmit:v,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle Selection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Select the vehicle to inspect or add a new one"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Vehicle Type"}),s?e.jsx(W,{type:"rectangle"}):e.jsxs("select",{value:x?.id||"",onChange:l=>c(l.target.value),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${o.vehicleIdNo?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
              dark:bg-gray-700 dark:text-white
            `,style:{minHeight:"56px"},children:[e.jsx("option",{value:"",children:"Select a vehicle (optional)"}),n.map(l=>e.jsx("option",{value:l.id,children:l.vehicleType&&l.vehicleMake?`${l.vehicleType} - ${l.vehicleMake} ${l.regUnit||""}`:l.regUnit||l.vehicleType||l.vehicleMake||"Unknown Vehicle"},l.id)),e.jsx("option",{value:"__ADD_NEW__",className:"font-semibold",children:"+ Add New Vehicle"})]}),!s&&n.length===0&&e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:'No vehicles found. Click "+ Add New Vehicle" to create one.'})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{type:"button",onClick:()=>j(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Add New Vehicle"]})}),x&&e.jsxs(f.div,{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-800 rounded-xl p-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-3",children:"Selected Vehicle Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Make/Type"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:[x.vehicleMake,x.vehicleType].filter(Boolean).join(" ")||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"License Plate"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:x.licenseNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Agency Unit"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:x.regUnit||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Status"}),e.jsx("span",{className:`
                  inline-block px-2 py-1 text-xs font-medium rounded-full
                  ${x.vehicleStatus==="Active"?"bg-green-100 text-green-800":x.vehicleStatus==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}
                `,children:x.vehicleStatus||"Unknown"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"odometerReading",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Odometer Reading (miles)"}),e.jsx("input",{type:"number",id:"odometerReading",value:t.odometerReading||"",onChange:l=>i("odometerReading",parseInt(l.target.value)||0),placeholder:"Enter current odometer reading",min:0,max:999999999,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${o.odometerReading?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            dark:bg-gray-700 dark:text-white
          `,style:{minHeight:"56px"}}),o.odometerReading&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.odometerReading})]}),e.jsxs("div",{className:"space-y-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Vehicle Information (Auto-populated, editable)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"License Number"}),e.jsx("input",{type:"text",value:t.vehicleLicenseNo||"",onChange:l=>i("vehicleLicenseNo",l.target.value),placeholder:"Enter license number",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Agency Reg/Unit"}),e.jsx("input",{type:"text",value:t.agencyRegUnit||"",onChange:l=>i("agencyRegUnit",l.target.value),placeholder:"Enter agency unit",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Vehicle Type"}),e.jsx("input",{type:"text",value:t.vehicleType||"",onChange:l=>i("vehicleType",l.target.value),placeholder:"e.g., Rescue, Engine, Ladder",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(k,{onTap:()=>r(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:r,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(k,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Inspection Items"})})]}),e.jsx(te,{isOpen:N,onClose:()=>j(!1),onVehicleAdded:g})]})},F=[{itemNumber:1,description:"Gauges and lights",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:2,description:"Seat belts",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:3,description:"Glass and mirrors",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:4,description:"Wipers and horn",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:5,description:"Engine compartment",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:6,description:"Fuel System",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:7,description:"Steering",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:8,description:"Brakes",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:9,description:"Drive line U-joints",status:"n/a",isSafetyItem:!1,reference:"Check play"},{itemNumber:10,description:"Springs and shocks",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:11,description:"Exhaust system",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:12,description:"Frame",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:13,description:"Tire and wheels",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:14,description:"Coupling devices / Emergency exit (buses)",status:"n/a",isSafetyItem:!1},{itemNumber:15,description:"Pump operation",status:"n/a",isSafetyItem:!1},{itemNumber:16,description:"Damage on incident",status:"n/a",isSafetyItem:!1},{itemNumber:17,description:"Other",status:"n/a",isSafetyItem:!1}],ae=({formData:t,onChange:i,onNext:d,onBack:r,errors:o})=>{const[n,p]=h.useState(new Set(["pre-trip","safety","operational"])),s=t.inspectionItems||F,m=h.useMemo(()=>s.some(c=>c.isSafetyItem&&c.status==="fail")?"hold":"release",[s]),x=(a,c)=>{const g=s.map(v=>v.itemNumber===a?{...v,status:c}:v);i("inspectionItems",g),i("releaseStatus",m)},y=a=>{const c=new Set(n);c.has(a)?c.delete(a):c.add(a),p(c)},N=a=>{const c=s.find(g=>g.itemNumber===a.itemNumber)||a;return e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[a.isSafetyItem&&e.jsx(L,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:[a.itemNumber,". ",a.description]}),a.reference&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.reference})]})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(k,{onTap:()=>x(a.itemNumber,"pass"),hapticType:"light",children:e.jsxs("button",{type:"button",onClick:()=>x(a.itemNumber,"pass"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${c.status==="pass"?"bg-green-500 text-white border-green-600 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:[e.jsx(E,{className:"w-4 h-4"}),"Pass"]})}),e.jsx(k,{onTap:()=>x(a.itemNumber,"fail"),hapticType:"medium",children:e.jsxs("button",{type:"button",onClick:()=>x(a.itemNumber,"fail"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${c.status==="fail"?"bg-red-500 text-white border-red-600 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:[e.jsx(Q,{className:"w-4 h-4"}),"Fail"]})}),e.jsx(k,{onTap:()=>x(a.itemNumber,"n/a"),hapticType:"light",children:e.jsx("button",{type:"button",onClick:()=>x(a.itemNumber,"n/a"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${c.status==="n/a"?"bg-gray-400 text-white border-gray-500 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:"N/A"})})]})]})]})},a.itemNumber)},j=(a,c,g,v)=>{const l=n.has(c);return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>y(c),className:"w-full p-4 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:a}),v&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:v})]}),e.jsx(Y,{className:`w-6 h-6 text-gray-600 dark:text-gray-400 transition-transform ${l?"rotate-180":""}`})]}),e.jsx(A,{children:l&&e.jsx(f.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"p-4 space-y-3",children:g.map(N)})})})]})};return e.jsxs(f.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle Inspection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Inspect all items and mark Pass, Fail, or N/A"})]}),e.jsx(f.div,{className:`
          p-4 rounded-xl border-2 flex items-center justify-between
          ${m==="hold"?"bg-red-50 border-red-500 dark:bg-red-900/20 dark:border-red-700":"bg-green-50 border-green-500 dark:bg-green-900/20 dark:border-green-700"}
        `,layout:!0,children:e.jsxs("div",{className:"flex items-center gap-3",children:[m==="hold"?e.jsx(L,{className:"w-6 h-6 text-red-600 dark:text-red-400"}):e.jsx(E,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold text-lg ${m==="hold"?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:m==="hold"?"ðŸ”´ HOLD FOR REPAIRS":"ðŸŸ¢ RELEASED"}),m==="hold"&&e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Safety Item â€“ Do Not Release Until Repaired"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[j("Pre-Trip Items","pre-trip",F.slice(0,5),"Items 1-5"),j("Safety Equipment","safety",F.slice(5,13),"âš ï¸ Items 6-13 - All Safety-Critical"),j("Operational Systems","operational",F.slice(13),"Items 14-17")]}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsx(k,{onTap:()=>r(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:r,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(k,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:d,className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Comments"})})]})]})},se=({formData:t,onChange:i,onNext:d,onBack:r})=>{const o=h.useRef(null),n=2e3,p=(t.additionalComments||"").length;return h.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${o.current.scrollHeight}px`)},[t.additionalComments]),e.jsxs(f.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Additional Comments"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add any notes, repair recommendations, or additional findings (optional)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"additionalComments",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Comments ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("textarea",{ref:o,id:"additionalComments",value:t.additionalComments||"",onChange:s=>i("additionalComments",s.target.value),placeholder:"Enter any additional comments, notes, or repair recommendations...",maxLength:n,rows:10,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-blue-500 focus:ring-blue-100 resize-none
            dark:bg-gray-800 dark:border-gray-600 dark:text-white
          `,style:{minHeight:"200px"}}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Detailed notes help with repairs and maintenance tracking"}),e.jsxs("p",{className:`text-sm font-medium ${p>n*.9?"text-red-600":"text-gray-600"}`,children:[p," / ",n]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Quick Suggestions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["No issues found","Minor wear observed","Requires immediate attention","Scheduled maintenance due","Pre-incident condition noted"].map(s=>e.jsxs("button",{type:"button",onClick:()=>{const m=t.additionalComments||"";i("additionalComments",`${m}${m?`
`:""}${s}`)},className:`
                px-3 py-2 text-sm rounded-lg bg-white dark:bg-gray-700
                border border-gray-300 dark:border-gray-600
                hover:bg-blue-50 hover:border-blue-300 dark:hover:bg-gray-600
                transition-colors text-gray-700 dark:text-gray-300
              `,children:["+ ",s]},s))})]}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsx(k,{onTap:()=>r(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:r,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(k,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:d,className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Inspector Signature"})})]})]})},ie=({formData:t,onChange:i,onNext:d,onBack:r,errors:o})=>{const[n,p]=h.useState(!!t.inspectorSignature),s=N=>{const j={imageData:N,signedAt:new Date().toISOString(),signedBy:t.inspectorNamePrint||"",ipAddress:void 0,deviceId:navigator.userAgent};i("inspectorSignature",j),p(!0),i("status","inspector_signed")},m=()=>{const N=new Date;return{date:N.toISOString().split("T")[0],time:N.toTimeString().slice(0,5)}},{date:x,time:y}=m();return e.jsxs(f.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Inspector Signature"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sign to lock the inspection form and proceed to review"})]}),n&&e.jsx(f.div,{className:"bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-500 rounded-xl p-4",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-100",children:"Form Locked"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Inspector signature has been recorded. Form is read-only."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorNamePrint",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Inspector Name (Print) *"}),e.jsx("input",{type:"text",id:"inspectorNamePrint",value:t.inspectorNamePrint||"",onChange:N=>i("inspectorNamePrint",N.target.value),placeholder:"Enter your full name",maxLength:100,disabled:n,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${n?"bg-gray-100 dark:bg-gray-800 border-gray-300 cursor-not-allowed":o.inspectorNamePrint?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),o.inspectorNamePrint&&!n&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.inspectorNamePrint})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Date"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(t.inspectorDate||x).toLocaleDateString()})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Time"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t.inspectorTime||y})]})]}),e.jsx("div",{children:e.jsx(V,{onSave:s,initialSignature:t.inspectorSignature?.imageData,disabled:n,label:"Inspector Signature"})}),n&&t.inspectorSignature&&e.jsx(f.div,{className:"bg-green-50 dark:bg-green-900/20 border-2 border-green-500 rounded-xl p-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-900 dark:text-green-100",children:"Signature Recorded"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["Signed by ",t.inspectorNamePrint," on"," ",new Date(t.inspectorSignature.signedAt).toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Notice:"})," By signing this form, you certify that the inspection was conducted in accordance with ICS-212 standards and that all information is accurate to the best of your knowledge."]})}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[!n&&e.jsx(k,{onTap:()=>r(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:r,className:`
                flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
                py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-gray-300
              `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(k,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:d,disabled:!n,className:`
              ${n?"flex-1":"flex-[2]"}
              font-bold py-4 px-6 rounded-xl transition-all shadow-lg
              focus:outline-none focus:ring-4
              ${n?"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-300 hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}
            `,style:{minHeight:"56px"},children:n?"Next: Review & Submit":"Sign Form to Continue"})})]})]})},ne=({formData:t,onChange:i,onBack:d,onGoToStep:r,onSubmit:o})=>{const[n,p]=h.useState(!1),[s,m]=h.useState(!!t.operatorSignature),x=g=>{const v={imageData:g,signedAt:new Date().toISOString(),signedBy:t.operatorNamePrint||"",ipAddress:void 0,deviceId:navigator.userAgent};i("operatorSignature",v),i("operatorDate",new Date().toISOString().split("T")[0]),i("operatorTime",new Date().toTimeString().slice(0,5)),m(!0)},y=async()=>{if(!s){I.error("Operator signature required");return}p(!0);try{await o(),I.success("Form submitted successfully!")}catch(g){I.error("Submission failed. Please try again."),console.error("Submission error:",g)}finally{p(!1)}},N=t.inspectionItems?.filter(g=>g.status==="pass").length||0,j=t.inspectionItems?.filter(g=>g.status==="fail").length||0,a=t.inspectionItems?.filter(g=>g.status==="n/a").length||0,c=t.releaseStatus||"release";return e.jsxs(f.div,{className:"space-y-6 p-4 md:p-6 pb-24",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Review all information before final submission"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Incident Information"}),e.jsxs("button",{type:"button",onClick:()=>r(0),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(D,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Incident Name"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.incidentName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Date/Time"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[t.inspectorDate," ",t.inspectorTime]})]}),t.orderNo&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Order Number"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.orderNo})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Vehicle Information"}),e.jsxs("button",{type:"button",onClick:()=>r(1),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(D,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Vehicle ID"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicleIdNo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Odometer"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[t.odometerReading?.toLocaleString()||"N/A"," mi"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"License Plate"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicleLicenseNo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Type"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicleType||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Inspection Results"}),e.jsxs("button",{type:"button",onClick:()=>r(2),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(D,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:N}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Passed"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:j}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Failed"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:a}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"N/A"})]})]}),e.jsx("div",{className:`
          p-4 rounded-lg text-center font-bold text-lg
          ${c==="hold"?"bg-red-100 text-red-900 dark:bg-red-900/30 dark:text-red-100":"bg-green-100 text-green-900 dark:bg-green-900/30 dark:text-green-100"}
        `,children:c==="hold"?"ðŸ”´ HOLD FOR REPAIRS":"ðŸŸ¢ RELEASED"})]}),t.additionalComments&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Additional Comments"}),e.jsxs("button",{type:"button",onClick:()=>r(3),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(D,{className:"w-4 h-4"})," Edit"]})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:t.additionalComments})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"Inspector Signature"}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.inspectorSignature?.imageData&&e.jsx("img",{src:t.inspectorSignature.imageData,alt:"Inspector signature",className:"h-20 border border-gray-300 rounded bg-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.inspectorNamePrint}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Signed: ",t.inspectorSignature&&new Date(t.inspectorSignature.signedAt).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl border-2 border-blue-200 dark:border-blue-800 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"Operator Signature Required"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"operatorNamePrint",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Operator Name (Print) *"}),e.jsx("input",{type:"text",id:"operatorNamePrint",value:t.operatorNamePrint||"",onChange:g=>i("operatorNamePrint",g.target.value),placeholder:"Enter operator full name",maxLength:100,disabled:s,className:`
                w-full px-4 py-3 text-base rounded-xl border-2 transition-all
                focus:outline-none focus:ring-4
                ${s?"bg-gray-100 dark:bg-gray-800 border-gray-300 cursor-not-allowed":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
              `})]}),e.jsx(V,{onSave:x,initialSignature:t.operatorSignature?.imageData,disabled:s,label:"Operator Signature"})]})]}),e.jsx("div",{className:"sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(k,{onTap:()=>d(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:d,disabled:n,className:`
                flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
                py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-gray-300
                disabled:opacity-50 disabled:cursor-not-allowed
              `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(k,{onTap:y,hapticType:"heavy",children:e.jsx("button",{type:"button",onClick:y,disabled:!s||n,className:`
                flex-[2] font-bold py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 flex items-center justify-center gap-2
                ${s&&!n?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-300 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}
              `,style:{minHeight:"56px"},children:n?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-5 h-5"}),"Submit Final Form"]})})})]})})]})},T=[{id:0,title:"Incident Info",component:ee},{id:1,title:"Vehicle",component:re},{id:2,title:"Inspection",component:ae},{id:3,title:"Comments",component:se},{id:4,title:"Inspector Sign",component:ie},{id:5,title:"Review & Submit",component:ne}],P={status:"draft",incidentName:"",orderNo:"",vehicleIdNo:"",vehicleLicenseNo:"",agencyRegUnit:"",vehicleType:"",selectedVehicleId:"",odometerReading:0,inspectionItems:[],additionalComments:"",releaseStatus:"release",inspectorDate:new Date().toISOString().split("T")[0],inspectorTime:new Date().toTimeString().slice(0,5),inspectorNamePrint:""},pe=()=>{const[t,i]=h.useState(0),[d,r]=h.useState(P),[o,n]=h.useState({}),[p,s]=h.useState(!1),[m,x]=h.useState(!1),[y,N]=h.useState(null);h.useEffect(()=>{const u=setInterval(()=>{if(d&&!p&&t>0){const b={formData:d,currentStep:t,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics212-draft",JSON.stringify(b)),I.success("Draft auto-saved",{duration:1500,icon:"ðŸ’¾"})}},3e4);return()=>clearInterval(u)},[d,t,p]),h.useEffect(()=>{const u=localStorage.getItem("ics212-draft");if(u)try{const b=JSON.parse(u);new Date(b.expiresAt)>new Date?(N(b),x(!0)):localStorage.removeItem("ics212-draft")}catch(b){console.error("Failed to parse draft:",b),localStorage.removeItem("ics212-draft")}},[]);const j=()=>{y&&(r(y.formData),i(y.currentStep),x(!1),I.success("Draft restored!"))},a=()=>{localStorage.removeItem("ics212-draft"),x(!1),N(null),I("Draft discarded",{icon:"ðŸ—‘ï¸"})},c=(u,b)=>{r(S=>({...S,[u]:b})),o[u]&&n(S=>{const C={...S};return delete C[u],C})},g=u=>{const b={};switch(u){case 0:(!d.incidentName||d.incidentName.length<3)&&(b.incidentName="Incident name must be at least 3 characters"),d.inspectorDate||(b.inspectorDate="Date is required"),d.inspectorTime||(b.inspectorTime="Time is required");break;case 1:const S=d.selectedVehicleId,C=d.vehicleIdNo||d.vehicleType||d.vehicleLicenseNo||d.agencyRegUnit;S||C||(b.vehicleIdNo="Please select or enter vehicle information"),(!d.odometerReading||d.odometerReading===0)&&(b.odometerReading="Odometer reading is required");break;case 4:(!d.inspectorNamePrint||(d.inspectorNamePrint||"").length<2)&&(b.inspectorNamePrint="Inspector name must be at least 2 characters"),d.inspectorSignature||(b.inspectorSignature="Signature is required");break}return n(b),Object.keys(b).length===0},v=()=>{g(t)?t<T.length-1&&i(t+1):I.error("Please complete all required fields")},l=()=>{t>0&&i(t-1)},w=u=>{u>=0&&u<T.length&&i(u)},O=()=>{const u={formData:d,currentStep:t,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics212-draft",JSON.stringify(u)),I.success("Draft saved manually!",{icon:"ðŸ’¾"})},M=()=>{confirm("Are you sure you want to clear all form data? This cannot be undone.")&&(r(P),i(0),n({}),localStorage.removeItem("ics212-draft"),I("Form cleared",{icon:"ðŸ—‘ï¸"}))},H=async()=>{try{const u={...d,submittedAt:new Date().toISOString(),status:"submitted"},b=await fetch("/api/ics212/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!b.ok)throw new Error("Submission failed");const S=await b.json();if(S.success)s(!0),localStorage.removeItem("ics212-draft"),I.success(`Form submitted! ID: ${S.formId}`),console.log("Submission result:",S);else throw new Error(S.error||"Submission failed")}catch(u){throw console.error("Submission error:",u),u}},_=T[t].component;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-40 shadow-sm",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/taskforce-io-logo.png",alt:"TASKFORCE IO",className:"w-10 h-10 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"ICS-212 Vehicle Safety Inspection"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Step ",t+1," of ",T.length,": ",T[t].title]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:O,className:"p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"Save Draft",children:e.jsx(U,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:M,className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"Clear Form",children:e.jsx(J,{className:"w-5 h-5"})})]})]}),e.jsx(z,{currentStep:t+1,totalSteps:T.length,labels:T.map(u=>u.title)})]})}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(A,{mode:"wait",children:e.jsx(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(_,{formData:d,onChange:c,onNext:v,onBack:l,onGoToStep:w,onSubmit:H,errors:o})},t)})}),e.jsx(A,{children:m&&e.jsx(f.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(f.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Resume Draft?"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["We found a saved draft from"," ",y&&new Date(y.savedAt).toLocaleString(),". Would you like to resume where you left off?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors",children:"Start Fresh"}),e.jsx("button",{type:"button",onClick:j,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors",children:"Resume Draft"})]})]})})}),e.jsx(A,{children:p&&e.jsx(f.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},children:e.jsxs(f.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-8 text-center",initial:{scale:.9,y:20},animate:{scale:1,y:0},children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Submitted!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your ICS-212 form has been successfully submitted and logged."}),e.jsx("button",{type:"button",onClick:()=>{s(!1),r(P),i(0)},className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors",children:"Start New Form"})]})})})]})};export{pe as ICS212Form,pe as default};
//# sourceMappingURL=ICS212Form-B0ECwSHx.js.map
