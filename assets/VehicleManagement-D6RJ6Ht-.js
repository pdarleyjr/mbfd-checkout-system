import{c as v,s as c}from"./index-O4SU3St8.js";import{j as e}from"./ui-CK6awmVK.js";import{r as l}from"./vendor-DtipCrYl.js";import{A as p,P as H,X as z}from"./config-BM_7qAFy.js";import{T as f}from"./TouchFeedback-jmoWXbnW.js";import{a as B,T as V,S as G}from"./SkeletonLoader-DZcLVolP.js";const J=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],de=v("mail",J);const W=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],X=v("pen",W);const K=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ie=v("refresh-cw",K);const Q=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ne=v("send",Q);function Y({isOpen:o,onClose:i,title:g,children:h}){return o?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:i}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:g}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6",children:h})]})]})}):null}function Z({isOpen:o,onClose:i,onConfirm:g,vehicleName:h,isDeleting:n}){return o?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:i}),e.jsx("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Delete Vehicle"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",e.jsx("strong",{children:h}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:i,disabled:n,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:n,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4"}),"Delete"]})})]})]})})]})}):null}function ce(){const[o,i]=l.useState([]),[g,h]=l.useState(!0),[n,U]=l.useState(""),[E,x]=l.useState(!1),[m,w]=l.useState("add"),[u,y]=l.useState(null),[A,k]=l.useState(!1),[t,s]=l.useState({regUnit:"",agency:"",vehicleMake:"",vehicleType:"",incidentId:"",vehicleId:"",features:"",licenseNumber:"",notes:"",vehicleStatus:"Active"}),[d,C]=l.useState({}),[j,S]=l.useState(!1),[L,M]=l.useState(!1);l.useEffect(()=>{N()},[]);const N=async()=>{try{const r=await fetch(`${p}/vehicles`);if(!r.ok)throw new Error("Failed to fetch vehicles");const a=await r.json();i(a.vehicles||[])}catch(r){console.error("Error fetching vehicles:",r),c({message:"Failed to load vehicles",type:"error"})}finally{h(!1)}},I=()=>{s({regUnit:"",agency:"",vehicleMake:"",vehicleType:"",incidentId:"",vehicleId:"",features:"",licenseNumber:"",notes:"",vehicleStatus:"Active"}),C({})},D=()=>{I(),w("add"),y(null),x(!0)},$=r=>{s({regUnit:r.regUnit||"",agency:r.agency||"",vehicleMake:r.vehicleMake||"",vehicleType:r.vehicleType||"",incidentId:r.incidentId||"",vehicleId:r.vehicleId||"",features:r.features||"",licenseNumber:r.licenseNumber||"",notes:r.notes||"",vehicleStatus:r.vehicleStatus||"Active"}),w("edit"),y(r),x(!0)},_=r=>{y(r),k(!0)},R=()=>{const r={};return t.regUnit.trim()?t.regUnit.length>100&&(r.regUnit="Registered Unit must be 100 characters or less"):r.regUnit="Registered Unit is required",t.vehicleMake.trim()||(r.vehicleMake="Vehicle Make is required"),[t.agency,t.vehicleType,t.incidentId,t.vehicleId,t.features,t.licenseNumber,t.notes].some(F=>F.trim())||(r.general="At least one additional field must be filled"),C(r),Object.keys(r).length===0},O=async r=>{if(r.preventDefault(),!R()){c({message:"Please fix the validation errors",type:"error"});return}S(!0);try{const a=m==="add"?`${p}/vehicles`:`${p}/vehicles/${u?.id}`,T=await fetch(a,{method:m==="add"?"POST":"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!T.ok){const q=await T.json();throw new Error(q.message||"Failed to save vehicle")}c({message:m==="add"?"Vehicle created successfully":"Vehicle updated successfully",type:"success"}),x(!1),I(),await N()}catch(a){console.error("Error saving vehicle:",a),c({message:a instanceof Error?a.message:"Failed to save vehicle",type:"error"})}finally{S(!1)}},P=async()=>{if(u){M(!0);try{const r=await fetch(`${p}/vehicles/${u.id}`,{method:"DELETE"});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to delete vehicle")}c({message:"Vehicle deleted successfully",type:"success"}),k(!1),y(null),await N()}catch(r){console.error("Error deleting vehicle:",r),c({message:r instanceof Error?r.message:"Failed to delete vehicle",type:"error"})}finally{M(!1)}}},b=o.filter(r=>{const a=n.toLowerCase();return r.regUnit?.toLowerCase().includes(a)||r.vehicleMake?.toLowerCase().includes(a)||r.vehicleType?.toLowerCase().includes(a)||r.licenseNumber?.toLowerCase().includes(a)});return g?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((r,a)=>e.jsx(B,{type:"card"},a))}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Vehicle Management"}),e.jsx(f,{children:e.jsxs("button",{onClick:D,className:"flex items-center justify-center gap-2 px-4 py-2 bg-[#0066FF] text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[e.jsx(H,{className:"w-5 h-5"}),"Add New Vehicle"]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4",children:e.jsx("input",{type:"search",placeholder:"Search vehicles by name, make, model, or license plate...",value:n,onChange:r=>U(r.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",b.length," vehicle",b.length!==1?"s":""]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.length===0?e.jsxs("div",{className:"col-span-full bg-white dark:bg-gray-800 rounded-lg shadow-sm p-8 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"No vehicles found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:n?"Try a different search term":"Get started by adding a new vehicle"})]}):b.map(r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"text-4xl",children:r.vehicleType?.toLowerCase().includes("truck")?"ðŸš›":"ðŸš—"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:r.regUnit}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.vehicleMake," ",r.vehicleType]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[r.licenseNumber&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"License:"}),e.jsx("span",{children:r.licenseNumber})]}),r.agency&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Agency:"}),e.jsx("span",{children:r.agency})]}),r.vehicleStatus&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Status:"}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${r.vehicleStatus==="Active"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:r.vehicleStatus})]})]}),r.notes&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2",children:r.notes})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[e.jsx(f,{children:e.jsx("a",{href:`/?vehicle=${encodeURIComponent(r.regUnit)}`,className:"flex-1 py-2 px-4 bg-[#0066FF] text-white rounded-lg text-center text-sm font-medium hover:bg-blue-700 transition-colors",children:"ðŸ“‹ New Inspection"})}),e.jsx(f,{children:e.jsx("button",{onClick:()=>$(r),className:"p-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Edit Vehicle",children:e.jsx(X,{className:"w-4 h-4"})})}),e.jsx(f,{children:e.jsx("button",{onClick:()=>_(r),className:"p-2 border border-red-300 dark:border-red-600 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete Vehicle",children:e.jsx(V,{className:"w-4 h-4"})})})]})]},r.id))}),e.jsx(Y,{isOpen:E,onClose:()=>x(!1),title:m==="add"?"Add New Vehicle":"Edit Vehicle",children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[d.general&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:d.general}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Registered Unit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.regUnit,onChange:r=>s({...t,regUnit:r.target.value}),className:`w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:text-white ${d.regUnit?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"e.g., USAR-01"}),d.regUnit&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.regUnit})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Agency"}),e.jsx("input",{type:"text",value:t.agency,onChange:r=>s({...t,agency:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., FEMA"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Make ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.vehicleMake,onChange:r=>s({...t,vehicleMake:r.target.value}),className:`w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:text-white ${d.vehicleMake?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"e.g., Ford, Chevrolet, International"}),d.vehicleMake&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.vehicleMake})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category/Type"}),e.jsx("input",{type:"text",value:t.vehicleType,onChange:r=>s({...t,vehicleType:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., Heavy Rescue Truck, Cargo Trailer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Incident ID"}),e.jsx("input",{type:"text",value:t.incidentId,onChange:r=>s({...t,incidentId:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., INC-2024-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Classification"}),e.jsx("input",{type:"text",value:t.vehicleId,onChange:r=>s({...t,vehicleId:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., VEHICLE-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Features"}),e.jsx("textarea",{value:t.features,onChange:r=>s({...t,features:r.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"Describe special features, equipment, or capabilities"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"License Number"}),e.jsx("input",{type:"text",value:t.licenseNumber,onChange:r=>s({...t,licenseNumber:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., ABC-1234"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Insurance Status"}),e.jsxs("select",{value:t.vehicleStatus,onChange:r=>s({...t,vehicleStatus:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Deployed",children:"Deployed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:r=>s({...t,notes:r.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),disabled:j,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-[#0066FF] text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4"}),m==="add"?"Create Vehicle":"Update Vehicle"]})})]})]})}),e.jsx(Z,{isOpen:A,onClose:()=>k(!1),onConfirm:P,vehicleName:u?.regUnit||"",isDeleting:L})]})}export{de as M,ie as R,ne as S,ce as V};
//# sourceMappingURL=VehicleManagement-D6RJ6Ht-.js.map
